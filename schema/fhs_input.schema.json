{
    "$schema": "https://json-schema.org/draft/2019-09/schema",
    "type": "object",
    "unevaluatedProperties": false,
    "properties": {
        "metadata": {
            "type": "object",
            "properties": {
                "hem_core_version": {
                    "type": "string",
                    "description": "The core version the input is written for. If there is a mismatch a warning will be printed"
                }
            },
            "description": "Metadata for the input file"
        },
        "PartGcompliance": {"type": "boolean"},
        "PartO_active_cooling_required": {"type": "boolean"},
        "BuildingLength": {
            "type": "number",
            "minimum": 0,
            "description": "The maximum horizontal distance (in metres) across the building footprint"
        },
        "BuildingWidth": {
            "type": "number",
            "minimum": 0,
            "description": "The maximum horizontal distance (in metres) perpendicular to the building length"
        },
        "GroundFloorArea": {
            "type": "number",
            "minimum": 0
        },
        "NumberOfBedrooms": {
            "type": "integer",
            "minimum": 0
        },
        "NumberOfWetRooms": {
            "type": "integer",
            "minimum": 0
        },
        "NumberOfTappedRooms": {
            "type": "integer",
            "minimum": 2,
            "description": "A tapped room is any room with a tapping point (e.g. sink, bath, or shower)"
        },
        "NumberOfUtilityRooms": {
            "type": "integer",
            "minimum": 0,
            "description": "A utility room is any that contains a sink or other feature or equipment that may reasonably be expected to produce significant quantities of water vapour"
        },
        "NumberOfBathrooms": {
            "type": "integer",
            "minimum": 0,
            "description": "A bathroom is any room that contains a bath or shower"
        },
        "NumberOfSanitaryAccommodations": {
            "type": "integer",
            "minimum": 0,
            "description": "Any space containing one or more flush toilets or urinals but not a bath or shower. Multiple cubicles counts as one space as long as there is free circulation of air throughout"
        },
        "NumberOfHabitableRooms": {
            "type": "integer",
            "minimum": 1,
            "description": "A habitable room is any that is not used solely as a kitchen, bathroom, utility, cellar or sanitary accommodation"
        },
        "HeatingControlType": {"enum": ["SeparateTempControl", "SeparateTimeAndTempControl"]},
        "ExternalConditions": {
            "type": "object",
            "unevaluatedProperties": false,
            "required": ["shading_segments"],
            "properties": {
                "air_temperatures": {
                    "type": "array",
                    "items": {"type": "number"}
                },
                "wind_speeds": {
                    "type": "array",
                    "items": {
                        "type": "number",
                        "minimum": 0
                    }
                },
                "wind_directions": {
                    "type": "array",
                    "items": {
                        "type": "number",
                        "minimum": 0,
                        "maximum": 360
                    }
                },
                "diffuse_horizontal_radiation": {
                    "type": "array",
                    "items": {"type": "number"}
                },
                "direct_beam_radiation": {
                    "type": "array",
                    "items": {"type": "number"}
                },
                "solar_reflectivity_of_ground": {
                    "type": "array",
                    "items": {
                        "type": "number",
                        "minimum": 0,
                        "maximum": 1
                    }
                },
                "latitude": {
                    "type": "number",
                    "minimum": -90,
                    "maximum": 90
                },
                "longitude": {
                    "type": "number",
                    "minimum": -180,
                    "maximum": 180
                },
                "timezone": {"type": "number"},
                "start_day": {"type": "number"},
                "end_day": {"type": "number"},
                "time_series_step": {"type": "number"},
                "january_first": {"type": "number"},
                "daylight_savings": {"type": "string"},
                "leap_day_included": {"type": "boolean"},
                "direct_beam_conversion_needed": {"type": "boolean"},
                "shading_segments": {
                    "type": "array",
                    "minLength": 8,
                    "maxLength": 36,
                    "items": {
                        "type": "object",
                        "unevaluatedProperties": false,
                        "required": ["start360", "end360"],
                        "properties": {
                            "start360": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 360
                            },
                            "end360": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 360
                            },
                            "shading": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "unevaluatedProperties": false,
                                    "required": [
                                        "type",
                                        "height",
                                        "distance"
                                    ],
                                    "properties": {
                                        "type": {"enum": ["obstacle", "overhang"]},
                                        "height": {
                                            "type": "number",
                                            "exclusiveMinimum": 0,
                                            "maximum": 400
                                        },
                                        "distance": {
                                            "type": "number",
                                            "exclusiveMinimum": 0,
                                            "maximum": 72000
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "Appliances": {
            "type": "object",
            "unevaluatedProperties": false,
            "patternProperties": {
                "Clothes_washing|Clothes_drying|Dishwasher|Fridge|Fridge-Freezer|Freezer|Hobs|Otherdevices|Oven": {
                    "enum": ["Not Installed", "Default"]
                }
            },
            "not": {
                "allOf": [
                    {"properties": {"Fridge": {"const": "Not Installed"}}},
                    {"properties": {"Fridge-Freezer": {"const": "Not Installed"}}}
                ]
            }
        },
        "ColdWaterSource": {
            "type": "object",
            "unevaluatedProperties": false,
            "properties": {
                "header tank": {"type": "object"},
                "mains water": {"type": "object"}
            },
            "oneOf": [
                {"required": ["header tank"]},
                {"required": ["mains water"]}
            ]
        },
        "EnergySupply": {
            "type": "object",
            "properties": {
                "mains elec": {
                    "type": "object",
                    "unevaluatedProperties": false,
                    "$ref": "#/$defs/ElectricityFuelProperties",
                    "properties": {
                        "fuel": {"const": "electricity"}
                    },
                    "required": ["fuel"]
                }
            },
            "required": ["mains elec"],
            "additionalProperties": {
                "type": "object",
                "required": ["fuel"],
                "unevaluatedProperties": false,
                "properties": {
                    "fuel": {
                        "enum": [
                            "mains_gas",
                            "electricity",
                            "LPG_bulk",
                            "LPG_bottled",
                            "LPG_condition_11F"
                        ]
                    }
                },
                "allOf": [
                    {
                        "if": {
                            "properties": {"fuel": {"const": "electricity"}}
                        },
                        "then": {
                            "$ref": "#/$defs/ElectricityFuelProperties"
                        }
                    },
                    {
                        "if": {
                            "properties": {"fuel": {"enum": ["LPG_bulk", "LPG_bottled", "LPG_condition_11F"]}}
                        },
                        "then": {
                            "required": ["is_export_capable"],
                            "properties": {
                                "is_export_capable": {"type": "boolean"}
                            }
                        }
                    }
                ]
            }
        },
        "OnSiteGeneration": {
            "type": "object",
            "additionalProperties": {
                "unevaluatedProperties": false,
                "type": "object",
                "required": [
                    "type",
                    "peak_power",
                    "ventilation_strategy",
                    "pitch",
                    "orientation360",
                    "base_height",
                    "height",
                    "width",
                    "EnergySupply",
                    "shading",
                    "inverter_peak_power_dc",
                    "inverter_peak_power_ac",
                    "inverter_is_inside",
                    "inverter_type"
                ],
                "properties": {
                    "type": {"enum": ["PhotovoltaicSystem"]},
                    "peak_power": {
                        "type": "number",
                        "minimum": 0.001,
                        "maximum": 100
                    },
                    "ventilation_strategy": {
                        "enum": [
                            "unventilated",
                            "moderately_ventilated",
                            "strongly_or_forced_ventilated",
                            "rear_surface_free"
                        ]},
                    "pitch": {
                        "type": "number",
                        "minimum": 0,
                        "maximum": 90
                    },
                    "orientation360": {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 360
                    },
                    "base_height": {
                        "type": "number",
                        "minimum": 0,
                        "maximum": 500
                    },
                    "height": {
                        "type": "number",
                        "exclusiveMinimum": 0,
                        "maximum": 100
                    },
                    "width": {
                        "type": "number",
                        "exclusiveMinimum": 0,
                        "maximum": 100
                    },
                    "EnergySupply": {"type": "string"},
                    "shading": {"$ref": "#/$defs/WindowShading"},
                    "inverter_peak_power_dc": {
                        "type": "number",
                        "exclusiveMinimum": 0
                    },
                    "inverter_peak_power_ac": {
                        "type": "number",
                        "exclusiveMinimum": 0
                    },
                    "inverter_is_inside": {"type": "boolean"},
                    "inverter_type": {"enum": ["string_inverter", "optimised_inverter"]}
                }
            }
        },
        "HotWaterSource": {
            "type": "object",
            "unevaluatedProperties": false,
            "properties": {
                "hw cylinder": {
                    "type": "object",
                    "unevaluatedProperties": false,
                    "required": ["type", "ColdWaterSource"],
                    "properties": {
                        "type": {
                            "enum": [
                                "StorageTank",
                                "SmartHotWaterTank",
                                "CombiBoiler",
                                "PointOfUse",
                                "HIU",
                                "HeatBattery"
                            ]
                        },
                        "ColdWaterSource": {"enum": ["header tank", "mains water"]}
                    },
                    "allOf": [
                        {
                            "if": {
                                "properties": {"type": {"const": "HIU"}}
                            },
                            "then": {
                                "properties": {
                                    "HeatSourceWet": {"type": "string"}
                                },
                                "required": [
                                    "HeatSourceWet"
                                ]
                            }
                        },
                        {
                            "if": {
                                "properties": {"type": {"const": "SmartHotWaterTank"}}
                            },
                            "then": {
                                "properties": {
                                    "EnergySupply_pump": {"type": "string"},
                                    "max_flow_rate_pump_l_per_min": {
                                        "type": "number",
                                        "exclusiveMinimum": 0
                                    },
                                    "power_pump_kW": {
                                        "type": "number",
                                        "exclusiveMinimum": 0
                                    },
                                    "temp_usable": {
                                        "type": "number",
                                        "minimum": 0,
                                        "maximum": 100
                                    }
                                },
                                "required": [
                                    "EnergySupply_pump",
                                    "max_flow_rate_pump_l_per_min",
                                    "power_pump_kW",
                                    "temp_usable"
                                ]
                            }
                        },
                        {
                            "if": {
                                "properties": {"type": {"const": "StorageTank"}}
                            },
                            "then": {
                                "properties": {
                                    "HeatSource": {
                                        "additionalProperties": {
                                            "required": ["thermostat_position"]
                                        }
                                    }
                                }
                            }
                        },
                        {
                            "if": {
                                "oneOf": [
                                    {"properties": {"type": {"const": "StorageTank"}}},
                                    {"properties": {"type": {"const": "SmartHotWaterTank"}}}
                                ]
                            },
                            "then": {
                                "required": [
                                    "volume",
                                    "daily_losses",
                                    "HeatSource"
                                ],
                                "properties": {
                                    "volume": {
                                        "type": "number",
                                        "minimum": 1,
                                        "maximum": 1000
                                    },
                                    "init_temp": {
                                        "type": "number",
                                        "minimum": 1,
                                        "maximum": 100
                                    },
                                    "daily_losses": {
                                        "type": "number",
                                        "minimum": 0.001,
                                        "maximum": 200
                                    },
                                    "primary_pipework": {
                                        "type": "array",
                                        "items": {
                                            "type": "object",
                                            "unevaluatedProperties": false,
                                            "required": [
                                                "location",
                                                "internal_diameter_mm",
                                                "external_diameter_mm",
                                                "length",
                                                "insulation_thermal_conductivity",
                                                "insulation_thickness_mm",
                                                "surface_reflectivity",
                                                "pipe_contents"
                                            ],
                                            "properties": {
                                                "location": {"enum": ["internal", "external"]},
                                                "internal_diameter_mm": {
                                                    "type": "number",
                                                    "minimum": 5,
                                                    "maximum": 50
                                                },
                                                "external_diameter_mm": {
                                                    "type": "number",
                                                    "minimum": 5,
                                                    "maximum": 50
                                                },
                                                "length": {
                                                    "type": "number",
                                                    "minimum": 0.05
                                                },
                                                "insulation_thermal_conductivity": {
                                                    "type": "number",
                                                    "exclusiveMinimum": 0
                                                },
                                                "insulation_thickness_mm": {
                                                    "type": "number",
                                                    "minimum": 0
                                                },
                                                "surface_reflectivity": {"type": "boolean"},
                                                "pipe_contents": {"enum": ["water", "glycol25"]}
                                            }
                                        }
                                    },
                                    "HeatSource": {
                                        "type": "object",
                                        "additionalProperties": {
                                            "type": "object",
                                            "unevaluatedProperties": false,
                                            "required": [
                                                "type",
                                                "heater_position"
                                            ],
                                            "properties": {
                                                "type": {
                                                    "enum": [
                                                        "ImmersionHeater",
                                                        "SolarThermalSystem",
                                                        "HeatSourceWet",
                                                        "HeatPump_HWOnly"
                                                    ]
                                                },
                                                "heater_position": {
                                                    "type": "number",
                                                    "minimum": 0,
                                                    "maximum": 1
                                                },
                                                "thermostat_position": {
                                                    "type": "number",
                                                    "minimum": 0,
                                                    "maximum": 1
                                                }
                                            },
                                            "allOf": [
                                                {
                                                    "if": {
                                                        "properties": {"type": {"const": "HeatPump_HWOnly"}}
                                                    },
                                                    "then": {
                                                        "required": [
                                                            "EnergySupply",
                                                            "power_max",
                                                            "tank_volume_declared",
                                                            "heat_exchanger_surface_area_declared",
                                                            "daily_losses_declared",
                                                            "in_use_factor_mismatch",
                                                            "test_data"
                                                        ],
                                                        "properties": {
                                                            "EnergySupply": {"type": "string"},
                                                            "power_max": {
                                                                "type": "number",
                                                                "exclusiveMinimum": 0
                                                            },
                                                            "tank_volume_declared": {
                                                                "type": "number",
                                                                "exclusiveMinimum": 0
                                                            },
                                                            "heat_exchanger_surface_area_declared": {
                                                                "type": "number",
                                                                "exclusiveMinimum": 0
                                                            },
                                                            "daily_losses_declared": {
                                                                "type": "number",
                                                                "exclusiveMinimum": 0
                                                            },
                                                            "in_use_factor_mismatch": {
                                                                "type": "number",
                                                                "exclusiveMinimum": 0
                                                            },
                                                            "test_data": {
                                                                "type": "object",
                                                                "unevaluatedProperties": false,
                                                                "patternProperties": {
                                                                    "M|L": {
                                                                        "type": "object",
                                                                        "unevaluatedProperties": false,
                                                                        "required": [
                                                                            "cop_dhw",
                                                                            "hw_tapping_prof_daily_total",
                                                                            "energy_input_measured",
                                                                            "power_standby",
                                                                            "hw_vessel_loss_daily"
                                                                        ],
                                                                        "properties": {
                                                                            "cop_dhw": {
                                                                                "type": "number",
                                                                                "exclusiveMinimum": 0
                                                                            },
                                                                            "hw_tapping_prof_daily_total": {
                                                                                "type": "number",
                                                                                "exclusiveMinimum": 0
                                                                            },
                                                                            "energy_input_measured": {
                                                                                "type": "number",
                                                                                "exclusiveMinimum": 0
                                                                            },
                                                                            "power_standby": {
                                                                                "type": "number",
                                                                                "exclusiveMinimum": 0
                                                                            },
                                                                            "hw_vessel_loss_daily": {
                                                                                "type": "number",
                                                                                "exclusiveMinimum": 0
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "if": {
                                                        "properties": {"type": {"const": "HeatSourceWet"}}
                                                    },
                                                    "then": {
                                                        "required": [
                                                            "EnergySupply",
                                                            "name"
                                                        ],
                                                        "properties": {
                                                            "EnergySupply": {"type": "string"},
                                                            "name": {"type": "string"},
                                                            "temp_flow_limit_upper": {
                                                                "type": "number",
                                                                "exclusiveMinimum": 0
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "if": {
                                                        "properties": {"type": {"const": "ImmersionHeater"}}
                                                    },
                                                    "then": {
                                                        "required": [
                                                            "power",
                                                            "EnergySupply"
                                                        ],
                                                        "properties": {
                                                            "power": {
                                                                "type": "number",
                                                                "minimum": 1,
                                                                "maximum": 10
                                                            },
                                                            "EnergySupply": {"type": "string"}
                                                        }
                                                    }
                                                },
                                                {
                                                    "if": {
                                                        "properties": {"type": {"const": "SolarThermalSystem"}}
                                                    },
                                                    "then": {
                                                        "required": [
                                                            "sol_loc",
                                                            "area_module",
                                                            "modules",
                                                            "peak_collector_efficiency",
                                                            "incidence_angle_modifier",
                                                            "first_order_hlc",
                                                            "second_order_hlc",
                                                            "collector_mass_flow_rate",
                                                            "power_pump",
                                                            "power_pump_control",
                                                            "EnergySupply",
                                                            "tilt",
                                                            "orientation360",
                                                            "solar_loop_piping_hlc"
                                                        ],
                                                        "properties": {
                                                            "sol_loc": {"enum": ["OUT", "NHS", "HS"]},
                                                            "area_module": {
                                                                "type": "number",
                                                                "exclusiveMinimum": 0
                                                            },
                                                            "modules": {
                                                                "type": "integer",
                                                                "minimum": 1
                                                            },
                                                            "peak_collector_efficiency": {
                                                                "type": "number",
                                                                "minimum": 0.1,
                                                                "maximum": 1
                                                            },
                                                            "incidence_angle_modifier": {
                                                                "type": "number",
                                                                "exclusiveMinimum": 0,
                                                                "maximum": 1
                                                            },
                                                            "first_order_hlc": {
                                                                "type": "number",
                                                                "exclusiveMinimum": 0,
                                                                "maximum": 100
                                                            },
                                                            "second_order_hlc": {
                                                                "type": "number",
                                                                "minimum": 0,
                                                                "maximum": 10
                                                            },
                                                            "collector_mass_flow_rate": {
                                                                "type": "number",
                                                                "exclusiveMinimum": 0
                                                            },
                                                            "power_pump": {
                                                                "type": "number",
                                                                "minimum": 0,
                                                                "maximum": 2
                                                            },
                                                            "power_pump_control": {
                                                                "type": "number",
                                                                "minimum": 0
                                                            },
                                                            "EnergySupply": {"type": "string"},
                                                            "tilt": {
                                                                "type": "number",
                                                                "minimum": 0,
                                                                "maximum": 90
                                                            },
                                                            "orientation360": {
                                                                "type": "number",
                                                                "minimum": 0,
                                                                "maximum": 360
                                                            },
                                                            "solar_loop_piping_hlc": {
                                                                "type": "number",
                                                                "exclusiveMinimum": 0
                                                            }
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                "if": {
                                    "properties": {
                                        "HeatSource": {
                                            "type": "object",
                                            "additionalProperties": {
                                                "type": "object",
                                                "properties": {"type": {"const": "HeatPump_HWOnly"}}
                                            }
                                        }
                                    }
                                },
                                "then": {
                                    "required": ["heat_exchanger_surface_area"],
                                    "properties": {
                                        "heat_exchanger_surface_area": {
                                            "type": "number",
                                            "exclusiveMinimum": 0
                                        }
                                    }
                                }
                            }
                        },
                        {
                            "if": {
                                "properties": {"type": {"const": "PointOfUse"}}
                            },
                            "then": {
                                "required": ["efficiency", "EnergySupply"],
                                "properties": {
                                    "efficiency": {
                                        "type": "number",
                                        "minimum": 0.1,
                                        "maximum": 1
                                    },
                                    "EnergySupply": {"type": "string"}
                                }
                            }
                        },
                        {
                            "if": {
                                "properties": {"type": {"const": "CombiBoiler"}}
                            },
                            "then": {
                                "required": [
                                    "HeatSourceWet",
                                    "daily_HW_usage",
                                    "separate_DHW_tests",
                                    "rejected_energy_1"
                                ],
                                "properties": {
                                    "HeatSourceWet": {
                                        "description": "References a key (e.g., 'boiler', 'hp', 'HeatNetwork', 'hb1') in $.HeatSourceWet",
                                        "reference_to": "$.heat_source_wet",
                                        "title": "Heatsourcewet",
                                        "type": "string"
                                    },
                                    "daily_HW_usage": {
                                        "description": "Daily hot water usage for the combi boiler system (unit: litre/day)",
                                        "exclusiveMinimum": 0,
                                        "title": "Daily Hw Usage",
                                        "type": "number"
                                    },
                                    "rejected_energy_1": {
                                        "anyOf": [
                                            {
                                                "exclusiveMinimum": 0,
                                                "type": "number"
                                            },
                                            {
                                                "type": "null"
                                            }
                                        ],
                                        "default": null,
                                        "description": "Rejected energy factor 1 for combi boiler efficiency calculations (unit: kWh)",
                                        "title": "Rejected Energy 1"
                                    },
                                    "rejected_factor_3": {
                                        "anyOf": [
                                            {
                                            "minimum": 0,
                                            "type": "number"
                                            },
                                            {
                                            "type": "null"
                                            }
                                        ],
                                        "default": null,
                                        "description": "Rejected energy factor 3 for combi boiler efficiency calculations (dimensionless)",
                                        "title": "Rejected Factor 3"
                                    },
                                    "separate_DHW_tests": {
                                        "enum": [
                                            "M&L",
                                            "M&S",
                                            "M_only",
                                            "No_additional_tests"
                                        ],
                                        "description": "Type of separate domestic hot water test performed on the combi boiler (M&L, M&S, M_only, or No_additional_tests)"
                                    },
                                    "storage_loss_factor_1": {
                                        "anyOf": [
                                          {
                                            "exclusiveMinimum": 0,
                                            "type": "number"
                                          },
                                          {
                                            "type": "null"
                                          }
                                        ],
                                        "default": null,
                                        "description": "Storage loss factor 1 for combi boiler efficiency calculations (unit: kWh/day)",
                                        "title": "Storage Loss Factor 1"
                                      },
                                    "storage_loss_factor_2": {
                                        "anyOf": [
                                            {
                                            "exclusiveMinimum": 0,
                                            "type": "number"
                                            },
                                            {
                                            "type": "null"
                                            }
                                        ],
                                        "default": null,
                                        "description": "Storage loss factor 2 for combi boiler efficiency calculations (dimensionless)",
                                        "title": "Storage Loss Factor 2"
                                    }
                                },
                                "if": {
                                    "anyOf": [
                                        {"properties": {"separate_DHW_tests": {"const": "M&L"}}},
                                        {"properties": {"separate_DHW_tests": {"const": "M&S"}}}
                                    ]
                                },
                                "then": {
                                    "required": ["storage_loss_factor_2", "rejected_factor_3"]
                                },
                                "else": {
                                    "required": ["storage_loss_factor_1"]
                                }
                            }
                        },
                        {
                            "if": {
                                "properties": {"type": {"const": "HeatBattery"}}
                            },
                            "then": {
                                "required": [
                                    "HeatSourceWet"
                                ],
                                "properties": {
                                    "HeatSourceWet": {"type": "string"}
                                }
                            }
                        }
                    ]
                }
            }
        },
        "HeatSourceWet": {
            "type": "object",
            "additionalProperties": {
                "type": "object",
                "unevaluatedProperties": false,
                "required": ["type", "EnergySupply", "is_heat_network"],
                "properties": {
                    "type": {"enum": ["HeatPump", "Boiler", "HIU", "HeatBattery"]},
                    "is_heat_network": {
                        "type": "boolean",
                        "description": "Is this HeatSourceWet a heat network? Put false if it is a HeatPump that is supplied by a HeatNetwork. In that case you will instead describe the heat network source under EnergySupply_heat_network not the EnergySupply of the pump"
                    }
                },
                "if": {
                    "properties": {"is_heat_network": {"const": true}}
                },
                "then": {
                    "properties": {
                        "heat_network_type": {
                            "enum": ["sleeved DHN", "unsleeved DHN", "communal"],
                            "description": "What type of heat network is present?"
                        },
                        "EnergySupply": {
                            "oneOf": [
                                {"type": "string"},
                                {
                                    "type": "object",
                                    "unevaluatedProperties": false,
                                    "required": ["name", "factor", "is_export_capable"],
                                    "properties": {
                                        "name": {"type": "string"},
                                        "is_export_capable": {"type": "boolean"},
                                        "factor": {
                                            "type": "object",
                                            "unevaluatedProperties": false,
                                            "required": [
                                                "Emissions Factor kgCO2e/kWh",
                                                "Emissions Factor kgCO2e/kWh including out-of-scope emissions",
                                                "Primary Energy Factor kWh/kWh delivered"
                                            ],
                                            "properties": {
                                                "Emissions Factor kgCO2e/kWh": {"type": "number"},
                                                "Emissions Factor kgCO2e/kWh including out-of-scope emissions": {"type": "number"},
                                                "Primary Energy Factor kWh/kWh delivered": {"type": "number"}
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    },
                    "required": ["heat_network_type"]
                },
                "else": {
                    "properties": {
                        "EnergySupply": {"type": "string"}
                    }
                },
                "allOf": [
                    {
                        "if": {"properties": {"type": {"const": "HeatPump"}}},
                        "then": {
                            "anyOf": [
                                {
                                    "properties": {
                                        "product_reference": {
                                            "description": "A unique reference to a product held within the HEM database (PCDB)",
                                            "title": "Reference to the product in the HEM database",
                                            "type": "string"
                                        },
                                        "type": {
                                            "const": "HeatPump",
                                            "title": "Type",
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "type",
                                        "product_reference"
                                    ],
                                    "title": "HeatSourceWetHeatPumpWithProductReference",
                                    "type": "object"
                                },
                                {
                                    "required": [
                                        "source_type",
                                        "sink_type",
                                        "backup_ctrl_type",
                                        "modulating_control",
                                        "temp_lower_operating_limit",
                                        "min_temp_diff_flow_return_for_hp_to_operate",
                                        "var_flow_temp_ctrl_during_test",
                                        "power_source_circ_pump",
                                        "power_standby",
                                        "power_crankcase_heater",
                                        "power_off",
                                        "test_data_EN14825",
                                        "time_constant_onoff_operation"
                                    ],
                                    "properties": {
                                        "source_type": {
                                            "enum": [
                                                "Ground",
                                                "OutsideAir",
                                                "ExhaustAirMEV",
                                                "ExhaustAirMVHR",
                                                "ExhaustAirMixed",
                                                "WaterGround",
                                                "WaterSurface",
                                                "HeatNetwork"
                                            ]
                                        },
                                        "sink_type": {"enum": ["Air", "Water", "Glycol25"]},
                                        "backup_ctrl_type": {"enum": ["None", "TopUp", "Substitute"]},
                                        "modulating_control": {"type": "boolean"},
                                        "min_modulation_rate_20": {
                                            "type": "number",
                                            "minimum": 0,
                                            "maximum": 1
                                        },
                                        "min_modulation_rate_35": {
                                            "type": "number",
                                            "minimum": 0,
                                            "maximum": 1
                                        },
                                        "min_modulation_rate_55": {
                                            "type": "number",
                                            "minimum": 0,
                                            "maximum": 1
                                        },
                                        "temp_return_feed_max": {
                                            "type": "number",
                                            "minimum": 4,
                                            "maximum": 80
                                        },
                                        "temp_lower_operating_limit": {
                                            "type": "number",
                                            "minimum": -30,
                                            "maximum": 0
                                        },
                                        "min_temp_diff_flow_return_for_hp_to_operate": {
                                            "type": "number",
                                            "minimum": 0,
                                            "maximum": 50
                                        },
                                        "var_flow_temp_ctrl_during_test": {"type": "boolean"},
                                        "power_heating_circ_pump": {
                                            "type": "number",
                                            "minimum": 0,
                                            "maximum": 1
                                        },
                                        "power_source_circ_pump": {
                                            "type": "number",
                                            "minimum": 0,
                                            "maximum": 1
                                        },
                                        "power_standby": {
                                            "type": "number",
                                            "exclusiveMinimum": 0
                                        },
                                        "power_crankcase_heater": {
                                            "type": "number",
                                            "minimum": 0
                                        },
                                        "power_off": {
                                            "type": "number",
                                            "minimum": 0
                                        },
                                        "BufferTank": {
                                            "type": "object",
                                            "unevaluatedProperties": false,
                                            "properties": {
                                                "daily_losses": {
                                                    "type": "number",
                                                    "exclusiveMinimum": 0
                                                },
                                                "pump_fixed_flow_rate": {
                                                    "type": "number",
                                                    "exclusiveMinimum": 0
                                                },
                                                "pump_power_at_flow_rate": {
                                                    "type": "number",
                                                    "exclusiveMinimum": 0
                                                },
                                                "volume": {
                                                    "type": "number",
                                                    "exclusiveMinimum": 0
                                                }
                                            },
                                            "required": [
                                                "daily_losses",
                                                "pump_fixed_flow_rate",
                                                "pump_power_at_flow_rate",
                                                "volume"
                                            ]
                                        },
                                        "power_heating_warm_air_fan": {
                                            "type": "number",
                                            "minimum": 0
                                        },
                                        "time_constant_onoff_operation": {
                                            "type": "number",
                                            "exclusiveMinimum": 0
                                        }
                                    },
                                    "allOf": [
                                        {
                                            "if": {
                                                "not": {
                                                    "properties": {"backup_ctrl_type": {"const": "None"}}
                                                }
                                            },
                                            "then": {
                                                "required": ["time_delay_backup"],
                                                "oneOf": [
                                                    {"required": ["boiler"]},
                                                    {"required": ["power_max_backup"]}
                                                ],
                                                "properties": {
                                                    "boiler": {
                                                        "unevaluatedProperties": false,
                                                        "description": "Boiler used as backup for heat pump systems",
                                                        "properties": {
                                                            "EnergySupply": {
                                                                "description": "References a key (e.g., 'mains elec', 'mains gas') in $.EnergySupply",
                                                                "reference_to": "$.energy_supply",
                                                                "title": "Energysupply",
                                                                "type": "string"
                                                            },
                                                            "EnergySupply_aux": {
                                                                "description": "References a key in $.EnergySupply for auxiliary electrical power",
                                                                "reference_to": "$.energy_supply",
                                                                "title": "Energysupply Aux",
                                                                "type": "string"
                                                            },
                                                            "boiler_location": {
                                                                "description": "Location of the boiler (internal or external to the building)",
                                                                "enum": [
                                                                    "internal",
                                                                    "external"
                                                                ],
                                                                "title": "HeatSourceLocation",
                                                                "type": "string"
                                                            },
                                                            "efficiency_full_load": {
                                                                "description": "Boiler net efficiency at full load (dimensionless, 0-1)",
                                                                "maximum": 1,
                                                                "exclusiveMinimum": 0,
                                                                "title": "Efficiency Full Load",
                                                                "type": "number"
                                                            },
                                                            "efficiency_part_load": {
                                                                "description": "Boiler net efficiency at part load (dimensionless, 0-1.12). Net efficiencies may exceed 1 in test data.",
                                                                "exclusiveMinimum": 0,
                                                                "maximum": 1.12,
                                                                "title": "Efficiency Part Load",
                                                                "type": "number"
                                                            },
                                                            "electricity_circ_pump": {
                                                                "description": "Electrical power consumption of circulation pump (unit: kW)",
                                                                "minimum": 0,
                                                                "title": "Electricity Circ Pump",
                                                                "type": "number"
                                                            },
                                                            "electricity_full_load": {
                                                                "description": "Electrical power consumption at full load (unit: kW)",
                                                                "exclusiveMinimum": 0,
                                                                "title": "Electricity Full Load",
                                                                "type": "number"
                                                            },
                                                            "electricity_part_load": {
                                                                "description": "Electrical power consumption at part load (unit: kW)",
                                                                "exclusiveMinimum": 0,
                                                                "title": "Electricity Part Load",
                                                                "type": "number"
                                                            },
                                                            "electricity_standby": {
                                                                "description": "Electrical power consumption in standby mode (unit: kW)",
                                                                "exclusiveMinimum": 0,
                                                                "title": "Electricity Standby",
                                                                "type": "number"
                                                            },
                                                            "modulation_load": {
                                                                "description": "Modulation load ratio (dimensionless, 0-1)",
                                                                "maximum": 1,
                                                                "minimum": 0,
                                                                "title": "Modulation Load",
                                                                "type": "number"
                                                            },
                                                            "rated_power": {
                                                                "description": "Rated power output of the boiler (unit: kW)",
                                                                "exclusiveMinimum": 0,
                                                                "title": "Rated Power",
                                                                "type": "number"
                                                            },
                                                            "cost_schedule_hybrid": {
                                                                "anyOf": [
                                                                    {
                                                                    "$ref": "#/$defs/BoilerCostScheduleHybrid"
                                                                    },
                                                                    {
                                                                    "type": "null"
                                                                    }
                                                                ],
                                                                "default": null
                                                            }
                                                        },
                                                        "required": [
                                                            "EnergySupply",
                                                            "EnergySupply_aux",
                                                            "boiler_location",
                                                            "efficiency_full_load",
                                                            "efficiency_part_load",
                                                            "electricity_circ_pump",
                                                            "electricity_full_load",
                                                            "electricity_part_load",
                                                            "electricity_standby",
                                                            "modulation_load",
                                                            "rated_power"
                                                        ],
                                                        "title": "HeatPumpBoiler",
                                                        "type": "object"
                                                    },
                                                    "power_max_backup": {
                                                        "type": "number",
                                                        "exclusiveMinimum": 0
                                                    },
                                                    "time_delay_backup": {
                                                        "type": "number",
                                                        "minimum": 0
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "if": {
                                                "properties": {"source_type": {"const": "HeatNetwork"}}
                                            },
                                            "then": {
                                                "required": [
                                                    "temp_distribution_heat_network",
                                                    "EnergySupply_heat_network"
                                                ],
                                                "properties": {
                                                    "temp_distribution_heat_network": {
                                                        "type": "number",
                                                        "exclusiveMinimum": 0
                                                    },
                                                    "EnergySupply_heat_network": {
                                                        "oneOf": [
                                                            {"type": "string"},
                                                            {
                                                                "type": "object",
                                                                "unevaluatedProperties": false,
                                                                "required": ["name", "factor", "is_export_capable"],
                                                                "properties": {
                                                                    "name": {"type": "string"},
                                                                    "is_export_capable": {"type": "boolean"},
                                                                    "factor": {
                                                                        "type": "object",
                                                                        "unevaluatedProperties": false,
                                                                        "required": [
                                                                            "Emissions Factor kgCO2e/kWh",
                                                                            "Emissions Factor kgCO2e/kWh including out-of-scope emissions",
                                                                            "Primary Energy Factor kWh/kWh delivered"
                                                                        ],
                                                                        "properties": {
                                                                            "Emissions Factor kgCO2e/kWh": {"type": "number"},
                                                                            "Emissions Factor kgCO2e/kWh including out-of-scope emissions": {"type": "number"},
                                                                            "Primary Energy Factor kWh/kWh delivered": {"type": "number"}
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "if": {
                                                "properties": {"source_type": {"const": "ExhaustAirMixed"}}
                                            },
                                            "then": {
                                                "required": [
                                                    "eahp_mixed_max_temp",
                                                    "eahp_mixed_min_temp"
                                                ],
                                                "properties": {
                                                    "eahp_mixed_max_temp": {
                                                        "type": "number",
                                                        "minimum": -273.15
                                                    },
                                                    "eahp_mixed_min_temp": {
                                                        "type": "number",
                                                        "minimum": -273.15
                                                    },
                                                    "test_data_EN14825": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "object",
                                                            "unevaluatedProperties": false,
                                                            "required": [
                                                                "test_letter",
                                                                "capacity",
                                                                "cop",
                                                                "design_flow_temp",
                                                                "temp_outlet",
                                                                "temp_source",
                                                                "temp_test",
                                                                "air_flow_rate",
                                                                "eahp_mixed_ext_air_ratio"
                                                            ],
                                                            "properties": {
                                                                "test_letter": {"enum": ["A", "B", "C", "D", "F"]},
                                                                "capacity": {
                                                                    "type": "number",
                                                                    "exclusiveMinimum": 0
                                                                },
                                                                "cop": {
                                                                    "type": "number",
                                                                    "exclusiveMinimum": 0
                                                                },
                                                                "design_flow_temp": {
                                                                    "type": "number",
                                                                    "exclusiveMinimum": 0
                                                                },
                                                                "temp_outlet": {
                                                                    "type": "number",
                                                                    "exclusiveMinimum": 0
                                                                },
                                                                "temp_source": {
                                                                    "type": "number",
                                                                    "minimum": -273.15
                                                                },
                                                                "temp_test": {
                                                                    "type": "number",
                                                                    "minimum": -273.15
                                                                },
                                                                "air_flow_rate": {
                                                                    "type":"number",
                                                                    "exclusiveMinimum":0
                                                                },
                                                                "eahp_mixed_ext_air_ratio": {
                                                                    "type":"number",
                                                                    "minimum":0,
                                                                    "maximum":1
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "else": {
                                                "properties": {
                                                    "test_data_EN14825": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "object",
                                                            "unevaluatedProperties": false,
                                                            "required": [
                                                                "test_letter",
                                                                "capacity",
                                                                "cop",
                                                                "design_flow_temp",
                                                                "temp_outlet",
                                                                "temp_source",
                                                                "temp_test"
                                                            ],
                                                            "properties": {
                                                                "test_letter": {"enum": ["A", "B", "C", "D", "F"]},
                                                                "capacity": {
                                                                    "type": "number",
                                                                    "exclusiveMinimum": 0
                                                                },
                                                                "cop": {
                                                                    "type": "number",
                                                                    "exclusiveMinimum": 0
                                                                },
                                                                "air_flow_rate": {
                                                                    "type":"number",
                                                                    "exclusiveMinimum": 0
                                                                },
                                                                "design_flow_temp": {
                                                                    "type": "number",
                                                                    "exclusiveMinimum": 0
                                                                },
                                                                "temp_outlet": {
                                                                    "type": "number",
                                                                    "exclusiveMinimum": 0
                                                                },
                                                                "temp_source": {
                                                                    "type": "number",
                                                                    "minimum": -273.15
                                                                },
                                                                "temp_test": {
                                                                    "type": "number",
                                                                    "minimum": -273.15
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    },
                    {
                        "if": {
                            "properties": {"type": {"const": "Boiler"}}
                        },
                        "then": {
                            "required": [
                                "EnergySupply_aux",
                                "rated_power",
                                "efficiency_full_load",
                                "efficiency_part_load",
                                "boiler_location",
                                "modulation_load",
                                "electricity_circ_pump",
                                "electricity_part_load",
                                "electricity_full_load",
                                "electricity_standby"
                            ],
                            "properties": {
                                "EnergySupply_aux": {"type": "string"},
                                "rated_power": {
                                    "type": "number",
                                    "exclusiveMinimum": 0
                                },
                                "efficiency_full_load": {
                                    "type": "number",
                                    "minimum": 0.1,
                                    "maximum": 1
                                },
                                "efficiency_part_load": {
                                    "type": "number",
                                    "minimum": 0.1,
                                    "maximum": 1.12
                                },
                                "boiler_location": {"enum": ["internal", "external"]},
                                "modulation_load": {
                                    "type": "number",
                                    "minimum": 0.1,
                                    "maximum": 1
                                },
                                "electricity_circ_pump": {
                                    "type": "number",
                                    "minimum": 0.001,
                                    "maximum": 1
                                },
                                "electricity_part_load": {
                                    "type": "number",
                                    "minimum": 0.001,
                                    "maximum": 1
                                },
                                "electricity_full_load": {
                                    "type": "number",
                                    "minimum": 0.001,
                                    "maximum": 1
                                },
                                "electricity_standby": {
                                    "type": "number",
                                    "exclusiveMinimum": 0,
                                    "maximum": 0.1
                                }
                            }
                        }
                    },
                    {
                        "if": {
                            "properties": {"type": {"const": "HeatBattery"}}
                        },
                        "then": {
                            "required": [
                                "battery_type"
                            ],
                            "properties": {
                                "battery_type": {
                                    "type": "string",
                                    "enum": ["dry_core", "pcm"]
                                }
                            },
                            "allOf": [
                                {
                                    "if": {
                                        "properties": {"battery_type": {"const": "pcm"}}
                                    },
                                    "then": {
                                        "required": [
                                            "electricity_circ_pump",
                                            "electricity_standby",
                                            "rated_charge_power",
                                            "max_rated_losses",
                                            "number_of_units",
                                            "simultaneous_charging_and_discharging",
                                            "heat_storage_kJ_per_K_above_Phase_transition",
                                            "heat_storage_kJ_per_K_below_Phase_transition",
                                            "heat_storage_kJ_per_K_during_Phase_transition",
                                            "phase_transition_temperature_upper",
                                            "phase_transition_temperature_lower",
                                            "max_temperature",
                                            "velocity_in_HEX_tube_at_1_l_per_min_m_per_s",
                                            "inlet_diameter_mm",
                                            "A",
                                            "B",
                                            "flow_rate_l_per_min",
                                            "temp_init"
                                        ],
                                        "properties": {
                                            "electricity_circ_pump": {
                                                "type": "number",
                                                "minimum": 0.001,
                                                "maximum": 1
                                            },
                                            "electricity_standby": {
                                                "type": "number",
                                                "exclusiveMinimum": 0,
                                                "maximum": 0.1
                                            },
                                            "rated_charge_power": {
                                                "type": "number",
                                                "exclusiveMinimum": 0
                                            },
                                            "max_rated_losses": {
                                                "type": "number",
                                                "exclusiveMinimum": 0
                                            },
                                            "number_of_units": {
                                                "type": "integer",
                                                "minimum": 1
                                            },
                                            "simultaneous_charging_and_discharging": {"type": "boolean"},
                                            "heat_storage_kJ_per_K_above_Phase_transition": {
                                                "type": "number",
                                                "exclusiveMinimum": 0
                                            },
                                            "heat_storage_kJ_per_K_below_Phase_transition": {
                                                "type": "number",
                                                "exclusiveMinimum": 0
                                            },
                                            "heat_storage_kJ_per_K_during_Phase_transition": {
                                                "type": "number",
                                                "exclusiveMinimum": 0
                                            },
                                            "phase_transition_temperature_upper": {
                                                "type": "number",
                                                "minimum": -273.15
                                            },
                                            "phase_transition_temperature_lower": {
                                                "type": "number",
                                                "minimum": -273.15
                                            },
                                            "velocity_in_HEX_tube_at_1_l_per_min_m_per_s": {
                                                "type": "number",
                                                "exclusiveMinimum": 0
                                            },
                                            "A": {"type": "number"},
                                            "B": {"type": "number"},
                                            "inlet_diameter_mm": {"type": "number"},
                                            "max_temperature": {
                                                "type": "number",
                                                "minimum": -273.15
                                            },
                                            "flow_rate_l_per_min": {
                                                "type": "number",
                                                "exclusiveMinimum": 0
                                            },
                                            "temp_init": {
                                                "description": "Initial temperature of the PCM heat battery at the start of simulation (unit: \u02daC)",
                                                "minimum": -273.15,
                                                "title": "Temp Init",
                                                "type": "number"
                                            }
                                        }
                                    }
                                },
                                {
                                    "if": {
                                        "properties": {"battery_type": {"const": "dry_core"}}
                                    },
                                    "then": {
                                        "required": [
                                            "EnergySupply",
                                            "electricity_circ_pump",
                                            "electricity_standby",
                                            "pwr_in",
                                            "rated_power_instant",
                                            "heat_storage_capacity",
                                            "number_of_units",
                                            "dry_core_min_output",
                                            "dry_core_max_output",
                                            "fan_pwr",
                                            "state_of_charge_init"
                                        ],
                                        "properties": {
                                            "electricity_circ_pump": {
                                                "type": "number"
                                            },
                                            "electricity_standby": {
                                                "type": "number"
                                            },
                                            "pwr_in": {
                                                "type": "number",
                                                "description": "Charging power (kW)"
                                            },
                                            "rated_power_instant": {
                                                "type": "number",
                                                "description": "Rated instantaneous power output (kW)"
                                            },
                                            "heat_storage_capacity": {
                                                "type": "number",
                                                "description": "Heat storage capacity (kWh)"
                                            },
                                            "EnergySupply": {"type": "string"},
                                            "number_of_units": {
                                                "type": "integer",
                                                "minimum": 1
                                            },
                                            "dry_core_min_output": {
                                                "type": "array",
                                                "items": {
                                                    "items": {
                                                        "type": "number"
                                                    },
                                                    "maxItems": 2,
                                                    "minItems": 2,
                                                    "type": "array"
                                                },
                                                "description": "Lookup table for minimum output based on charge level"
                                            },
                                            "dry_core_max_output": {
                                                "type": "array",
                                                "items": {
                                                    "items": {
                                                        "type": "number"
                                                    },
                                                    "maxItems": 2,
                                                    "minItems": 2,
                                                    "type": "array"
                                                },
                                                "description": "Lookup table for maximum output based on charge level"
                                            },
                                            "fan_pwr": {
                                                "type": "number",
                                                "description": "Fan power (W)"
                                            },
                                            "state_of_charge_init": {
                                                "description": "State of charge at initialisation of dry core heat storage (ratio)",
                                                "maximum": 1.0,
                                                "minimum": 0.0,
                                                "title": "State Of Charge Init",
                                                "type": "number"
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "if": {
                            "properties": {"type": {"const": "HIU"}}
                        },
                        "then": {
                            "required": [
                                "HIU_daily_loss",
                                "power_max",
                                "building_level_distribution_losses"
                            ],
                            "properties": {
                                "HIU_daily_loss": {
                                    "type": "number",
                                    "exclusiveMinimum": 0
                                },
                                "power_max": {
                                    "type": "number",
                                    "exclusiveMinimum": 0
                                },
                                "building_level_distribution_losses": {
                                    "type": "number",
                                    "minimum": 0
                                }
                            }
                        }
                    }
                ]
            }
        },
        "HotWaterDemand": {
            "type": "object",
            "unevaluatedProperties": false,
            "required": [
                "Other"
            ],
            "properties": {
                "Shower": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "object",
                        "unevaluatedProperties": false,
                        "required": [
                            "type",
                            "ColdWaterSource"
                        ],
                        "properties": {
                            "type": {"enum": ["MixerShower", "InstantElecShower"]},
                            "ColdWaterSource": {"enum": ["header tank", "mains water"]}
                        },
                        "if": {
                            "properties": {"type": {"const": "MixerShower"}}
                        },
                        "then": {
                            "required": ["flowrate"],
                            "properties": {
                                "flowrate": {
                                    "type": "number",
                                    "minimum": 8,
                                    "maximum": 15
                                },
                                "HotWaterSource": {"type": "string"},
                                "WWHRS": {"type": "string"},
                                "WWHRS_configuration": {"enum": ["A", "B", "C"]}
                            }
                        },
                        "else": {
                            "required": [
                                "rated_power",
                                "EnergySupply"
                            ],
                            "properties": {
                                "rated_power": {
                                    "type": "number",
                                    "exclusiveMinimum": 0,
                                    "maximum": 30
                                },
                                "EnergySupply": {"type": "string"}
                            }
                        }
                    }
                },
                "Bath": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "object",
                        "unevaluatedProperties": false,
                        "required": [
                            "size",
                            "ColdWaterSource"
                        ],
                        "properties": {
                            "size": {
                                "type": "number",
                                "exclusiveMinimum": 0
                            },
                            "ColdWaterSource": {"enum": ["header tank", "mains water"]},
                            "HotWaterSource": {"type": "string"}
                        }
                    }
                },
                "Other": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "object",
                        "unevaluatedProperties": false,
                        "required": [
                            "flowrate",
                            "ColdWaterSource"
                        ],
                        "properties": {
                            "flowrate": {
                                "type": "number",
                                "minimum": 0.1,
                                "maximum": 15
                            },
                            "ColdWaterSource": {"enum": ["header tank", "mains water"]},
                            "HotWaterSource": {"type": "string"}
                        }
                    },
                    "minProperties": 1
                }
            }
        },
        "Events": {
            "type": "object"
        },
        "WWHRS": {
            "type": "object",
            "additionalProperties": {
                "type": "object",
                "unevaluatedProperties": false,
                "required": [
                    "type",
                    "ColdWaterSource",
                    "flow_rates",
                    "system_a_efficiencies"
                ],
                "properties": {
                    "type": {
                        "type": "string",
                        "const": "WWHRS_Instantaneous"
                    },
                    "ColdWaterSource": {"enum": ["header tank", "mains water"]},
                    "flow_rates": {
                        "type": "array",
                        "items": {
                            "type": "number",
                            "minimum": 0.1,
                            "maximum": 500
                        }
                    },
                    "system_a_efficiencies": {
                        "type": "array",
                        "items": {
                            "exclusiveMinimum": 0,
                            "maximum": 100,
                            "type": "number"
                        },
                        "description": "Measured efficiencies for System A at the test flow rates"
                    },
                    "system_a_utilisation_factor": {
                        "type": "number",
                        "maximum": 1,
                        "exclusiveMinimum": 0,
                        "description": "Utilisation factor for System A"
                    },
                    "system_b_efficiencies": {
                        "type": "array",
                        "items": {
                            "exclusiveMinimum": 0,
                            "maximum": 100,
                            "type": "number"
                        },
                        "description": "Measured efficiencies for System B (optional, uses system_b_efficiency_factor if not provided)"
                    },
                    "system_b_efficiency_factor": {
                        "type": "number",
                        "maximum": 1,
                        "exclusiveMinimum": 0,
                        "description": "Reduction factor for System B efficiency (default 0.81)"
                    },
                    "system_b_utilisation_factor": {
                        "type": "number",
                        "maximum": 1,
                        "exclusiveMinimum": 0,
                        "description": "Utilisation factor for System B (optional, defaults to system_a_utilisation_factor)"
                    },
                    "system_c_efficiencies": {
                        "type": "array",
                        "items": {
                            "exclusiveMinimum": 0,
                            "maximum": 100,
                            "type": "number"
                        },
                        "description": "Measured efficiencies for System C (optional, uses system_c_efficiency_factor if not provided)"
                    },
                    "system_c_efficiency_factor": {
                        "type": "number",
                        "maximum": 1,
                        "exclusiveMinimum": 0,
                        "description": "Reduction factor for System C efficiency (default 0.87)"
                    },
                    "system_c_utilisation_factor": {
                        "type": "number",
                        "maximum": 1,
                        "exclusiveMinimum": 0,
                        "description": "Utilisation factor for System C (optional, defaults to system_a_utilisation_factor)"
                    }
                }
            }
        },
        "SpaceHeatSystem": {
            "type": "object",
            "additionalProperties": {
                "type": "object",
                "unevaluatedProperties": false,
                "required": ["type"],
                "properties": {
                    "type": {
                        "enum": [
                            "ElecStorageHeater",
                            "InstantElecHeater",
                            "WetDistribution",
                            "WarmAir"
                        ]
                    }
                },
                "allOf": [
                    {
                        "if": {
                            "properties": {"type": {"const": "ElecStorageHeater"}}
                        },
                        "then": {
                            "required": [
                                "pwr_in",
                                "rated_power_instant",
                                "storage_capacity",
                                "air_flow_type",
                                "frac_convective",
                                "n_units",
                                "EnergySupply",
                                "Zone",
                                "dry_core_min_output",
                                "dry_core_max_output",
                                "state_of_charge_init"
                            ],
                            "properties": {
                                "pwr_in": {
                                    "type": "number",
                                    "minimum": 0.1,
                                    "maximum": 70
                                },
                                "rated_power_instant": {
                                    "type": "number",
                                    "minimum": 0.1,
                                    "maximum": 70
                                },
                                "storage_capacity": {
                                    "type": "number",
                                    "minimum": 0
                                },
                                "air_flow_type": {"enum": ["fan-assisted", "damper-only"]},
                                "frac_convective": {
                                    "type": "number",
                                    "minimum": 0
                                },
                                "n_units": {
                                    "type": "integer",
                                    "minimum": 0,
                                    "maximum": 100
                                },
                                "EnergySupply": {"type": "string"},
                                "Zone": {"type": "string"},
                                "dry_core_min_output": {
                                    "type": "array",
                                    "items": {
                                        "type": "array",
                                        "items": {"type": "number"}
                                    }
                                },
                                "dry_core_max_output": {
                                    "type": "array",
                                    "items": {
                                        "type": "array",
                                        "items": {"type": "number"}
                                    }
                                },
                                "state_of_charge_init": {
                                    "description": "State of charge at initialisation of dry core heat storage (ratio)",
                                    "maximum": 1.0,
                                    "minimum": 0.0,
                                    "title": "State Of Charge Init",
                                    "type": "number"
                                }
                            },
                            "if": {
                                "properties": {"air_flow_type": {"const": "fan-assisted"}}
                            },
                            "then": {
                                "required": ["fan_pwr"],
                                "properties": {
                                    "fan_pwr": {
                                        "type": "number",
                                        "minimum": 0
                                    }
                                }
                            }

                        }
                    },
                    {
                        "if": {
                            "properties": {"type": {"const": "InstantElecHeater"}}
                        },
                        "then": {
                            "required": [
                                "rated_power",
                                "convective_type",
                                "EnergySupply"
                            ],
                            "properties": {
                                "rated_power": {
                                    "type": "number",
                                    "minimum": 0.1,
                                    "maximum": 70
                                },
                                "convective_type": {
                                    "enum": [
                                        "Air heating (convectors, fan coils etc.)",
                                        "Free heating surface (radiators, radiant panels etc.)",
                                        "Floor heating, low temperature radiant tube heaters, luminous heaters, wood stoves",
                                        "Wall heating, radiant ceiling panels, accumulation stoves",
                                        "Ceiling heating, radiant ceiling electric heating"
                                    ]
                                },
                                "EnergySupply": {"type": "string"}
                            }
                        }
                    },
                    {
                        "if": {
                            "properties": {"type": {"const": "WetDistribution"}}
                        },
                        "then": {
                            "required": [
                                "emitters",
                                "temp_diff_emit_dsgn",
                                "variable_flow",
                                "HeatSource",
                                "ecodesign_controller",
                                "design_flow_temp",
                                "Zone"
                            ],
                            "properties": {
                                "EnergySupply": {"type": "string"},
                                "emitters": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "unevaluatedProperties": false,
                                        "required": [
                                            "wet_emitter_type"
                                        ],
                                        "properties": {
                                            "wet_emitter_type": {
                                                "enum": ["radiator", "ufh", "fancoil"]
                                            }
                                        },
                                        "allOf": [
                                            {
                                                "if": {
                                                    "properties": {"wet_emitter_type": {"const": "radiator"}}
                                                },
                                                "then": {
                                                    "anyOf": [
                                                        {
                                                            "properties": {
                                                                "product_reference": {
                                                                    "description": "A unique reference to a product held within the HEM database (PCDB)",
                                                                    "title": "Reference to the product in the HEM database",
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "required": [
                                                                "product_reference"
                                                            ],
                                                            "title": "RadiatorWithProductReference",
                                                            "type": "object"
                                                        },
                                                        {
                                                            "required": ["n"],
                                                            "properties": {
                                                                "length": {
                                                                    "type": "number",
                                                                    "exclusiveMinimum": 0
                                                                },
                                                                "n": {
                                                                    "type": "number",
                                                                    "exclusiveMinimum": 0,
                                                                    "maximum": 2
                                                                }
                                                            },
                                                            "if": {
                                                                "required": ["length"]
                                                            },
                                                            "then": {
                                                                "required": ["c_per_m"],
                                                                "properties": {
                                                                    "c_per_m": {
                                                                        "type": "number",
                                                                        "exclusiveMinimum": 0
                                                                    },
                                                                    "thermal_mass_per_m": {
                                                                        "type": "number",
                                                                        "exclusiveMinimum": 0
                                                                    }
                                                                }
                                                            },
                                                            "else": {
                                                                "required": ["c"],
                                                                "properties": {
                                                                    "c": {
                                                                        "type": "number",
                                                                        "exclusiveMinimum": 0,
                                                                        "maximum": 2
                                                                    },
                                                                    "thermal_mass": {
                                                                        "type": "number",
                                                                        "exclusiveMinimum": 0
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "if": {
                                                    "properties": {"wet_emitter_type": {"const": "ufh"}}
                                                },
                                                "then": {
<<<<<<< HEAD
                                                    "required": [
                                                        "equivalent_specific_thermal_mass",
                                                        "system_performance_factor",
                                                        "emitter_floor_area"
                                                    ],
                                                    "properties": {
                                                        "equivalent_specific_thermal_mass": {
                                                            "type": "number",
                                                            "minimum": 0
                                                        },
                                                        "system_performance_factor": {
                                                            "type": "number",
                                                            "minimum": 0
                                                        },
                                                        "emitter_floor_area": {
                                                            "type": "number",
                                                            "exclusiveMinimum": 0
                                                        }
                                                    }
=======
                                                    "anyOf": [
                                                        {
                                                            "properties": {
                                                                "product_reference": {
                                                                    "description": "A unique reference to a product held within the HEM database (PCDB)",
                                                                    "title": "Reference to the product in the HEM database",
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "required": [
                                                                "product_reference"
                                                            ],
                                                            "title": "UfhWithProductReference",
                                                            "type": "object"
                                                        },
                                                        {
                                                            "required": [
                                                                "equivalent_specific_thermal_mass",
                                                                "system_performance_factor",
                                                                "emitter_floor_area",
                                                                "frac_convective"
                                                            ],
                                                            "properties": {
                                                                "equivalent_specific_thermal_mass": {
                                                                    "type": "number",
                                                                    "minimum": 0
                                                                },
                                                                "system_performance_factor": {
                                                                    "type": "number",
                                                                    "minimum": 0
                                                                },
                                                                "emitter_floor_area": {
                                                                    "type": "number",
                                                                    "minimum": 0
                                                                },
                                                                "frac_convective": {"type": "number"}
                                                            }
                                                        }
                                                    ]
>>>>>>> 6522afcd (extend api schema files to allow product reference for ufh)
                                                }
                                            },
                                            {
                                                "if": {
                                                    "properties": {"wet_emitter_type": {"const": "fancoil"}}
                                                },
                                                "then": {
                                                    "required": [
                                                        "n_units",
                                                        "fancoil_test_data",
                                                        "frac_convective"
                                                    ],
                                                    "properties": {
                                                        "n_units": {
                                                            "type": "integer",
                                                            "minimum": 1
                                                        },
                                                        "fancoil_test_data": {
                                                            "type": "object",
                                                            "unevaluatedProperties": false,
                                                            "required": [
                                                                "fan_speed_data",
                                                                "fan_power_W"
                                                            ],
                                                            "properties": {
                                                                "fan_speed_data": {
                                                                    "type": "array",
                                                                    "items": {
                                                                        "type": "object",
                                                                        "unevaluatedProperties": false,
                                                                        "required": [
                                                                            "temperature_diff",
                                                                            "power_output"
                                                                        ],
                                                                        "properties": {
                                                                            "temperature_diff": {
                                                                                "type": "number",
                                                                                "exclusiveMinimum": 0
                                                                            },
                                                                            "power_output": {
                                                                                "type": "array",
                                                                                "items": {
                                                                                    "type": "number",
                                                                                    "minimum": 0
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                },
                                                                "fan_power_W": {
                                                                    "type": "array",
                                                                    "items": {
                                                                        "type": "number",
                                                                        "exclusiveMinimum": 0
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        "frac_convective": {"type": "number"}
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "temp_diff_emit_dsgn": {
                                    "type": "number",
                                    "exclusiveMinimum": 0,
                                    "maximum": 70
                                },
                                "variable_flow": {"type": "boolean"},
                                "bypass_fraction_recirculated": {
                                    "type": "number",
                                    "minimum": 0,
                                    "exclusiveMaximum": 1
                                },
                                "HeatSource": {
                                    "type": "object",
                                    "unevaluatedProperties": false,
                                    "required": ["name"],
                                    "properties": {
                                        "name": {"type": "string"},
                                        "temp_flow_limit_upper": {
                                            "type": "number",
                                            "exclusiveMinimum": 0
                                        }
                                    }
                                },
                                "ecodesign_controller": {
                                    "type": "object",
                                    "unevaluatedProperties": false,
                                    "required": [
                                        "ecodesign_control_class"
                                    ],
                                    "properties": {
                                        "ecodesign_control_class": {
                                            "type": "integer",
                                            "minimum": 1,
                                            "maximum": 8
                                        },
                                        "min_outdoor_temp": {
                                            "type": "integer",
                                            "minimum": -60,
                                            "maximum": 30
                                        },
                                        "max_outdoor_temp": {
                                            "type": "integer",
                                            "minimum": 10,
                                            "maximum": 50
                                        },
                                        "min_flow_temp": {
                                            "type": "integer",
                                            "minimum": 20,
                                            "maximum": 120
                                        }
                                    }
                                },
                                "design_flow_temp": {
                                    "type": "number",
                                    "minimum": 20,
                                    "maximum": 120
                                },
                                "Zone": {"type": "string"}
                            },
                            "allOf": [
                                {
                                    "if": {
                                        "oneOf": [
                                            {"properties": {"ecodesign_control_class": {"const": 2}}},
                                            {"properties": {"ecodesign_control_class": {"const": 3}}},
                                            {"properties": {"ecodesign_control_class": {"const": 6}}},
                                            {"properties": {"ecodesign_control_class": {"const": 7}}}
                                        ]
                                    },
                                    "then": {
                                        "required": [
                                            "min_outdoor_temp",
                                            "max_outdoor_temp",
                                            "min_flow_temp"
                                        ]
                                    }
                                },
                                {
                                    "if": {
                                        "properties": {"variable_flow": {"const": true}}
                                    },
                                    "then": {
                                        "required": ["min_flow_rate", "max_flow_rate"],
                                        "properties": {
                                            "min_flow_rate": {
                                                "type": "number",
                                                "exclusiveMinimum": 0
                                            },
                                            "max_flow_rate": {
                                                "type": "number",
                                                "exclusiveMinimum": 0
                                            }
                                        }
                                    },
                                    "else": {
                                        "required": ["design_flow_rate"],
                                        "properties": {
                                            "design_flow_rate": {
                                                "type": "number",
                                                "exclusiveMinimum": 0
                                            }
                                        }
                                    }
                                },
                                {
                                    "if": {
                                        "properties": {
                                            "emitters": {
                                                "type": "array",
                                                "contains": {
                                                    "type": "object",
                                                    "properties": {
                                                        "wet_emitter_type": {"const": "radiator"}
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    "then": {
                                        "required": ["thermal_mass"],
                                        "properties": {
                                            "thermal_mass": {
                                                "type": "number",
                                                "exclusiveMinimum": 0
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "if": {
                            "properties": {"type": {"const": "WarmAir"}}
                        },
                        "then": {
                            "required": [
                                "temp_diff_emit_dsgn",
                                "frac_convective",
                                "HeatSource"
                            ],
                            "properties": {
                                "temp_diff_emit_dsgn": {
                                    "type": "number",
                                    "maximum": 70
                                },
                                "frac_convective": {
                                    "type": "number",
                                    "minimum": 0.1,
                                    "maximum": 1
                                },
                                "HeatSource": {
                                    "type": "object",
                                    "unevaluatedProperties": false,
                                    "required": ["name"],
                                    "properties": {
                                        "name": {"type": "string"},
                                        "temp_flow_limit_upper": {
                                            "type": "number",
                                            "exclusiveMinimum": 0
                                        }
                                    }
                                }
                            }
                        }
                    }
                ]
            }
        },
        "SpaceCoolSystem": {
            "type": "object",
            "additionalProperties": {
                "type": "object",
                "unevaluatedProperties": false,
                "required": [
                    "type",
                    "cooling_capacity",
                    "efficiency",
                    "frac_convective",
                    "EnergySupply"
                ],
                "properties": {
                    "type": {"enum": ["AirConditioning"]},
                    "cooling_capacity": {
                        "type": "number",
                        "exclusiveMinimum": 0
                    },
                    "efficiency": {
                        "type": "number",
                        "exclusiveMinimum": 0,
                        "maximum": 25
                    },
                    "frac_convective": {
                        "type": "number",
                        "minimum": 0,
                        "maximum": 1
                    },
                    "EnergySupply": {"type": "string"},
                    "advanced_start": {"type": "number"},
                    "temp_setback": {"type": "number"}
                }
            }
        },
        "General": {
            "type": "object",
            "unevaluatedProperties": false,
            "required": [
                "storeys_in_dwelling",
                "build_type"
            ],
            "properties": {
                "storeys_in_dwelling": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Number of storeys within this dwelling"
                },
                "build_type": {"enum": ["flat", "house"]}
            },
            "if": {
                "properties": {"build_type": {"const": "flat"}}
            },
            "then": {
                "required": [
                    "storey_of_dwelling",
                    "storeys_in_building"
                ],
                "properties": {
                    "storey_of_dwelling": {
                        "type": "integer",
                        "minimum": -50,
                        "maximum": 199,
                        "description": "What storey of the main building is the flat on? For multi-story flats, enter the lowest storey the unit occupies"
                    },
                    "storeys_in_building": {
                        "type": "integer",
                        "minimum": 1,
                        "description": "Number of storeys, within the entire building, that contain dwellings. This should be greater than or equal to storeys_in_dwelling."
                    }
                }
            }
        },
        "InfiltrationVentilation": {
            "type": "object",
            "unevaluatedProperties": false,
            "required": [
                "shield_class",
                "terrain_class",
                "ventilation_zone_base_height",
                "altitude",
                "noise_nuisance",
                "Vents",
                "Leaks"
            ],
            "properties": {
                "shield_class": {
                    "enum": [
                        "Open",
                        "Normal",
                        "Shielded"
                    ]
                },
                "terrain_class": {
                    "enum": [
                        "OpenWater",
                        "OpenField",
                        "Suburban",
                        "Urban"
                    ]
                },
                "ventilation_zone_base_height": {
                    "type": "number",
                    "minimum": -150,
                    "maximum": 750
                },
                "altitude": {
                    "type": "number",
                    "minimum": -150,
                    "maximum": 7200
                },
                "ach_min_static_calcs": {
                    "type": "number",
                    "minimum": 0
                },
                "ach_max_static_calcs": {
                    "type": "number",
                    "minimum": 0
                },
                "noise_nuisance": {"type": "boolean"},
                "Vents": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "object",
                        "unevaluatedProperties": false,
                        "required": [
                            "mid_height_air_flow_path",
                            "area_cm2",
                            "orientation360",
                            "pitch"
                        ],
                        "properties": {
                            "mid_height_air_flow_path": {
                                "type": "number",
                                "minimum": 1,
                                "maximum": 60
                            },
                            "area_cm2": {
                                "type": "number",
                                "minimum": 1,
                                "maximum": 999999
                            },
                            "orientation360": {
                                "type": "number",
                                "minimum": 0,
                                "maximum": 360
                            },
                            "pitch": {
                                "type": "number",
                                "minimum": 0,
                                "maximum": 180
                            }
                        }
                    }
                },
                "Leaks": {
                    "type": "object",
                    "unevaluatedProperties": false,
                    "required": [
                        "ventilation_zone_height",
                        "test_pressure",
                        "test_result",
                        "env_area"
                    ],
                    "properties": {
                        "ventilation_zone_height": {
                            "type": "number",
                            "minimum": 1,
                            "maximum": 120
                        },
                        "test_pressure": {"enum": ["Standard", "Pulse test only"]},
                        "test_result": {
                            "type": "number",
                            "exclusiveMinimum": 0
                        },
                        "env_area": {
                            "type": "number",
                            "minimum": 5,
                            "maximum": 72000
                        }
                    }
                },
                "MechanicalVentilation": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "object",
                        "unevaluatedProperties": false,
                        "required": [
                            "sup_air_flw_ctrl",
                            "sup_air_temp_ctrl",
                            "vent_type",
                            "EnergySupply",
                            "design_outdoor_air_flow_rate"
                        ],
                        "properties": {
                            "sup_air_flw_ctrl": {"enum": ["ODA", "LOAD"]},
                            "sup_air_temp_ctrl": {"enum": ["NO_CTRL", "CONST", "ODA_COMP", "LOAD_COMP"]},
                            "design_zone_cooling_covered_by_mech_vent": {"type": "number"},
                            "design_zone_heating_covered_by_mech_vent": {"type": "number"},
                            "vent_type": {
                                "enum": [
                                    "Decentralised continuous MEV",
                                    "Centralised continuous MEV",
                                    "MVHR",
                                    "Intermittent MEV"
                                ]
                            },
                            "EnergySupply": {"type": "string"},
                            "design_outdoor_air_flow_rate": {
                                "type": "number",
                                "exclusiveMinimum": 0
                            },
                            "SFP_in_use_factor": {
                                "minimum": 1,
                                "type": "number",
                                "default": 1,
                                "description": "Adjustment factor to be applied to SFP to account for e.g. type of ducting. Typical range 1 - 2.5",
                                "title": "Sfp In Use Factor"
                            }
                        },
                        "allOf": [
                            {
                                "if": {
                                    "properties": {"vent_type": {"const": "MVHR"}}
                                },
                                "then": {
                                    "required": ["mvhr_eff", "mvhr_location", "ductwork", "position_intake", "position_exhaust"],
                                    "properties": {
                                        "mvhr_eff": {
                                            "type": "number",
                                            "minimum": 0,
                                            "maximum": 1
                                        },
                                        "mvhr_location": {"enum": ["inside", "outside"]},
                                        "ductwork": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "unevaluatedProperties": false,
                                                "required": [
                                                    "cross_section_shape",
                                                    "internal_diameter_mm",
                                                    "external_diameter_mm",
                                                    "length",
                                                    "insulation_thermal_conductivity",
                                                    "insulation_thickness_mm",
                                                    "reflective",
                                                    "duct_type"
                                                ],
                                                "properties": {
                                                    "cross_section_shape": {"enum": ["circular", "rectangular"]},
                                                    "internal_diameter_mm": {
                                                        "type": "number",
                                                        "minimum": 0,
                                                        "maximum": 1000
                                                    },
                                                    "external_diameter_mm": {
                                                        "type": "number",
                                                        "minimum": 0,
                                                        "maximum": 1000
                                                    },
                                                    "length": {
                                                        "type": "number",
                                                        "minimum": 0
                                                    },
                                                    "insulation_thermal_conductivity": {
                                                        "type": "number",
                                                        "minimum": 0
                                                    },
                                                    "insulation_thickness_mm": {
                                                        "type": "number",
                                                        "minimum": 0,
                                                        "maximum": 100
                                                    },
                                                    "reflective": {"type": "boolean"},
                                                    "duct_type": {"enum": ["supply", "extract", "intake", "exhaust"]}
                                                }
                                            }
                                        },
                                        "position_intake": {
                                            "type": "object",
                                            "properties": {
                                                "mid_height_air_flow_path": {
                                                    "type": "number",
                                                    "minimum": 1,
                                                    "maximum": 60,
                                                    "description": "Mid height of air flow path relative to ventilation zone (unit: m)"
                                                },
                                                "orientation360": {
                                                    "type": "number",
                                                    "minimum": 0,
                                                    "maximum": 360,
                                                    "description": "The orientation angle of the inclined surface, expressed as the geographical azimuth angle of the horizontal projection of the inclined surface normal, 0 to 360 (unit: \u02da)"
                                                },
                                                "pitch": {
                                                    "type": "number",
                                                    "minimum": 0,
                                                    "maximum": 180,
                                                    "description": "Tilt angle of the surface from horizontal, between 0 and 180, where 0 means the external surface is facing up, 90 means the external surface is vertical and 180 means the external surface is facing down (unit: \u02da)"
                                                }
                                            }
                                        },
                                        "position_exhaust": {
                                            "type": "object",
                                            "properties": {
                                                "mid_height_air_flow_path": {
                                                    "type": "number",
                                                    "minimum": 1,
                                                    "maximum": 60,
                                                    "description": "Mid height of air flow path relative to ventilation zone (unit: m)"
                                                },
                                                "orientation360": {
                                                    "type": "number",
                                                    "minimum": 0,
                                                    "maximum": 360,
                                                    "description": "The orientation angle of the inclined surface, expressed as the geographical azimuth angle of the horizontal projection of the inclined surface normal, 0 to 360 (unit: \u02da)"
                                                },
                                                "pitch": {
                                                    "type": "number",
                                                    "minimum": 0,
                                                    "maximum": 180,
                                                    "description": "Tilt angle of the surface from horizontal, between 0 and 180, where 0 means the external surface is facing up, 90 means the external surface is vertical and 180 means the external surface is facing down (unit: \u02da)"
                                                }
                                            }
                                        }
                                    }
                                },
                                "else": {
                                    "oneOf": [
                                        {
                                            "required": ["mid_height_air_flow_path", "orientation360", "pitch"],
                                            "properties": {
                                                "mid_height_air_flow_path": {
                                                    "type": "number",
                                                    "minimum": 1,
                                                    "maximum": 60,
                                                    "description": "Mid height of air flow path relative to ventilation zone (unit: m)"
                                                },
                                                "orientation360": {
                                                    "type": "number",
                                                    "minimum": 0,
                                                    "maximum": 360,
                                                    "description": "The orientation angle of the inclined surface, expressed as the geographical azimuth angle of the horizontal projection of the inclined surface normal, 0 to 360 (unit: \u02da)"
                                                },
                                                "pitch": {
                                                    "type": "number",
                                                    "minimum": 0,
                                                    "maximum": 180,
                                                    "description": "Tilt angle of the surface from horizontal, between 0 and 180, where 0 means the external surface is facing up, 90 means the external surface is vertical and 180 means the external surface is facing down (unit: \u02da)"
                                                }
                                            }
                                        },
                                        {
                                            "required": ["position_exhaust"],
                                            "properties": {
                                                "position_exhaust": {
                                                    "type": "object",
                                                    "properties": {
                                                        "mid_height_air_flow_path": {
                                                            "type": "number",
                                                            "minimum": 1,
                                                            "maximum": 60,
                                                            "description": "Mid height of air flow path relative to ventilation zone (unit: m)"
                                                        },
                                                        "orientation360": {
                                                            "type": "number",
                                                            "minimum": 0,
                                                            "maximum": 360,
                                                            "description": "The orientation angle of the inclined surface, expressed as the geographical azimuth angle of the horizontal projection of the inclined surface normal, 0 to 360 (unit: \u02da)"
                                                        },
                                                        "pitch": {
                                                            "type": "number",
                                                            "minimum": 0,
                                                            "maximum": 180,
                                                            "description": "Tilt angle of the surface from horizontal, between 0 and 180, where 0 means the external surface is facing up, 90 means the external surface is vertical and 180 means the external surface is facing down (unit: \u02da)"
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "if": {
                                    "anyOf": [
                                        {
                                            "properties": {"vent_type": {"const": "Decentralised continuous MEV"}}
                                        },
                                        {
                                            "properties": {"vent_type": {"const": "Intermittent MEV"}}
                                        }
                                    ]
                                },
                                "then": {
                                    "required": ["SFP"],
                                    "properties": {
                                        "SFP": {
                                            "type": "number",
                                            "exclusiveMinimum": 0,
                                            "description": "Specific fan power, assumed inclusive of any in use factors unless SFP_in_use_factor also provided (unit: W/l/s)"

                                        }
                                    }
                                }
                            },
                            {
                                "if": {
                                    "anyOf": [
                                        {
                                            "properties": {"vent_type": {"const": "Centralised continuous MEV"}}
                                        },
                                        {
                                            "properties": {"vent_type": {"const": "MVHR"}}
                                        }
                                    ]
                                },
                                "then": {
                                    "required": ["measured_fan_power", "measured_air_flow_rate"],
                                    "properties": {
                                        "measured_fan_power": {"type": "number"},
                                        "measured_air_flow_rate": {"type": "number"}
                                    }
                                }
                            }
                        ]
                    }
                }
            }
        },
        "Zone": {
            "type": "object",
            "additionalProperties": {
                "type": "object",
                "unevaluatedProperties": false,
                "required": [
                    "livingroom_area",
                    "restofdwelling_area",
                    "volume",
                    "Lighting",
                    "BuildingElement",
                    "ThermalBridging"
                ],
                "properties": {
                    "SpaceHeatSystem": {
                        "type": ["string", "array"],
                        "items": {"type": "string"}
                    },
                    "SpaceCoolSystem": {
                        "type": ["string", "array"],
                        "items": {"type": "string"}
                    },
                    "livingroom_area": {
                        "type": "number",
                        "minimum": 0,
                        "maximum": 10000
                    },
                    "restofdwelling_area": {
                        "type": "number",
                        "minimum": 0,
                        "maximum": 10000
                    },
                    "volume": {
                        "type": "number",
                        "minimum": 0,
                        "maximum": 50000
                    },
                    "Lighting": {
                        "type": "object",
                        "unevaluatedProperties": false,
                        "required": [
                            "bulbs"
                        ],
                        "properties": {
                            "bulbs": {
                                "type": "array",
                                "minItems": 1,
                                "items": {
                                    "type": "object",
                                    "unevaluatedProperties": false,
                                    "required": [
                                        "count",
                                        "power",
                                        "efficacy"
                                    ],
                                    "properties": {
                                        "count": {
                                            "type": "integer",
                                            "minimum": 1
                                        },
                                        "power": {
                                            "type": "number",
                                            "minimum": 0
                                        },
                                        "efficacy": {
                                            "type": "number",
                                            "minimum": 0
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "BuildingElement": {
                        "type": "object",
                        "additionalProperties": {
                            "type": "object",
                            "unevaluatedProperties": false,
                            "properties": {
                                "type": {
                                    "enum": [
                                        "BuildingElementAdjacentConditionedSpace",
                                        "BuildingElementAdjacentUnconditionedSpace_Simple",
                                        "BuildingElementGround",
                                        "BuildingElementOpaque",
                                        "BuildingElementPartyWall",
                                        "BuildingElementTransparent"
                                    ]
                                },
                                "thermal_resistance_construction": {
                                    "type": "number",
                                    "minimum": 0.01,
                                    "maximum": 50
                                },
                                "u_value": {
                                    "type": "number",
                                    "minimum": 0.01,
                                    "maximum": 10
                                }
                            },
                            "oneOf": [
                                {"required": ["thermal_resistance_construction"]},
                                {"required": ["u_value"]}
                            ],
                            "required": ["type"],
                            "allOf": [
                                {
                                    "if": {
                                        "anyOf": [
                                            {
                                                "properties": {
                                                    "type": {"const": "BuildingElementAdjacentConditionedSpace"}
                                                }
                                            },
                                            {
                                                "properties": {
                                                    "type": {"const": "BuildingElementAdjacentUnconditionedSpace_Simple"}
                                                }
                                            }
                                        ]
                                    },
                                    "then": {
                                        "required": [
                                            "area",
                                            "areal_heat_capacity",
                                            "mass_distribution_class",
                                            "pitch"
                                        ],
                                        "properties": {
                                            "pitch": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 180
                                            },
                                            "areal_heat_capacity": {
                                                "enum": ["Very light", "Light", "Medium", "Heavy", "Very heavy"]
                                            },
                                            "mass_distribution_class": {
                                                "$ref": "#/$defs/MassDistributionClass"
                                            },
                                            "area": {
                                                "type": "number",
                                                "minimum": 0.01,
                                                "maximum": 10000
                                            }
                                        }
                                    }
                                },
                                {
                                    "if": {
                                        "properties": {
                                            "type": {"const": "BuildingElementAdjacentUnconditionedSpace_Simple"}
                                        }
                                    },
                                    "then": {
                                        "required": [
                                            "thermal_resistance_unconditioned_space"
                                        ],
                                        "properties": {
                                            "thermal_resistance_unconditioned_space": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 3
                                            }
                                        }
                                    }
                                },
                                {
                                    "if": {
                                        "properties": {"type": {"const": "BuildingElementGround"}}
                                    },
                                    "then": {
                                        "required": [
                                            "u_value",
                                            "total_area",
                                            "floor_type",
                                            "thickness_walls",
                                            "perimeter",
                                            "psi_wall_floor_junc",
                                            "thermal_resistance_floor_construction",
                                            "areal_heat_capacity",
                                            "mass_distribution_class",
                                            "area"
                                        ],
                                        "properties": {
                                            "total_area": {
                                                "type": "number",
                                                "minimum": 5
                                            },
                                            "floor_type": {
                                                "enum": [
                                                    "Slab_no_edge_insulation",
                                                    "Slab_edge_insulation",
                                                    "Suspended_floor",
                                                    "Heated_basement",
                                                    "Unheated_basement"
                                                ]
                                            },
                                            "thickness_walls": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 100
                                            },
                                            "perimeter": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 1000
                                            },
                                            "psi_wall_floor_junc": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 2
                                            },
                                            "thermal_resistance_floor_construction": {
                                                "type": "number",
                                                "minimum": 0.000001,
                                                "maximum": 50
                                            },
                                            "areal_heat_capacity": {
                                                "enum": ["Very light", "Light", "Medium", "Heavy", "Very heavy"]
                                            },
                                            "mass_distribution_class": {
                                                "$ref": "#/$defs/MassDistributionClass"
                                            },
                                            "area": {
                                                "type": "number",
                                                "minimum": 5,
                                                "maximum": 10000
                                            }
                                        },
                                        "allOf": [
                                            {
                                                "if": {
                                                    "properties": {"floor_type": {"const": "Slab_edge_insulation"}}
                                                },
                                                "then": {
                                                    "required": ["edge_insulation"],
                                                    "properties": {
                                                        "edge_insulation": {
                                                            "type": "array",
                                                            "items": {
                                                                "type": "object",
                                                                "unevaluatedProperties": false,
                                                                "required": ["type", "edge_thermal_resistance"],
                                                                "properties": {
                                                                    "type": {"enum": ["horizontal", "vertical"]},
                                                                    "edge_thermal_resistance": {
                                                                        "type": "number",
                                                                        "exclusiveMinimum": 0
                                                                    }
                                                                },
                                                                "allOf": [
                                                                    {
                                                                        "if": {
                                                                            "properties": {"type": {"const": "horizontal"}}
                                                                        },
                                                                        "then": {
                                                                            "required": ["width"],
                                                                            "properties": {
                                                                                "width": {
                                                                                    "type": "number",
                                                                                    "description": "Width of horizontal edge insulation (unit: m)",
                                                                                    "exclusiveMinimum": 0
                                                                                }
                                                                            }
                                                                        }
                                                                    },
                                                                    {
                                                                        "if": {
                                                                            "properties": {"type": {"const": "vertical"}}
                                                                        },
                                                                        "then": {
                                                                            "required": ["depth"],
                                                                            "properties": {
                                                                                "depth": {
                                                                                    "type": "number",
                                                                                    "description": "Depth of vertical edge insulation (unit: m)",
                                                                                    "exclusiveMinimum": 0
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "if": {
                                                    "properties": {"floor_type": {"const": "Suspended_floor"}}
                                                },
                                                "then": {
                                                    "required": [
                                                        "height_upper_surface",
                                                        "thermal_transm_walls",
                                                        "shield_fact_location",
                                                        "thickness_walls",
                                                        "thermal_resist_insul",
                                                        "area_per_perimeter_vent"
                                                    ],
                                                    "properties": {
                                                        "height_upper_surface": {
                                                            "type": "number",
                                                            "minimum": 0,
                                                            "maximum": 100
                                                        },
                                                        "thermal_transm_walls": {
                                                            "type": "number",
                                                            "minimum": 0,
                                                            "maximum": 100
                                                        },
                                                        "area_per_perimeter_vent": {"type": "number"},
                                                        "shield_fact_location": {
                                                            "enum": [
                                                                "Sheltered",
                                                                "Average",
                                                                "Exposed"
                                                            ]
                                                        },
                                                        "thickness_walls": {
                                                            "type": "number",
                                                            "minimum": 0,
                                                            "maximum": 100
                                                        },
                                                        "thermal_resist_insul": {
                                                            "type": "number",
                                                            "minimum": 0,
                                                            "maximum": 100
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "if": {
                                                    "anyOf": [
                                                        {
                                                            "properties": {"floor_type": {"const": "Heated_basement"}}
                                                        },
                                                        {
                                                            "properties": {"floor_type": {"const": "Unheated_basement"}}
                                                        }
                                                    ]
                                                },
                                                "then": {
                                                    "required": [
                                                        "thickness_walls",
                                                        "depth_basement_floor",
                                                        "thermal_resist_walls_base"
                                                    ],
                                                    "properties": {
                                                        "thickness_walls": {
                                                            "type": "number",
                                                            "minimum": 0,
                                                            "maximum": 100
                                                        },
                                                        "depth_basement_floor": {
                                                            "type": "number",
                                                            "exclusiveMinimum": 0
                                                        },
                                                        "thermal_resist_walls_base": {"type": "number"}
                                                    }
                                                }
                                            },
                                            {
                                                "if": {
                                                    "properties": {"floor_type": {"const": "Unheated_basement"}}
                                                },
                                                "then": {
                                                    "required": [
                                                        "thermal_transm_envi_base",
                                                        "thermal_transm_walls",
                                                        "height_basement_walls"
                                                    ],
                                                    "properties": {
                                                        "thermal_transm_envi_base": {"type": "number"},
                                                        "thermal_transm_walls": {"type": "number"},
                                                        "height_basement_walls": {"type": "number"}
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "if": {
                                        "properties": {"type": {"const": "BuildingElementOpaque"}}
                                    },
                                    "then": {
                                        "required": [
                                            "areal_heat_capacity",
                                            "mass_distribution_class",
                                            "base_height",
                                            "height",
                                            "width",
                                            "area",
                                            "pitch"
                                        ],
                                        "properties": {
                                            "pitch": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 180
                                            },
                                            "is_unheated_pitched_roof": {"type": "boolean"},
                                            "is_external_door": {"type": "boolean"},
                                            "colour": {
                                                "enum": ["Light", "Intermediate", "Dark"]
                                            },
                                            "areal_heat_capacity": {
                                                "enum": ["Very light", "Light", "Medium", "Heavy", "Very heavy"]
                                            },
                                            "mass_distribution_class": {
                                                "$ref": "#/$defs/MassDistributionClass"
                                            },
                                            "base_height": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 500
                                            },
                                            "height": {
                                                "type": "number",
                                                "minimum": 0.001,
                                                "maximum": 50
                                            },
                                            "width": {
                                                "type": "number",
                                                "minimum": 0.001,
                                                "maximum": 100
                                            },
                                            "area": {
                                                "type": "number",
                                                "minimum": 0.01,
                                                "maximum": 10000
                                            }
                                        },
                                        "allOf": [
                                            {
                                                "if": {
                                                    "properties": {
                                                        "pitch": {
                                                            "type": "number",
                                                            "maximum": 60
                                                        }
                                                    }
                                                },
                                                "then": {
                                                    "required": ["is_unheated_pitched_roof", "colour"]
                                                }
                                            },
                                            {
                                                "if": {
                                                    "properties": {
                                                        "pitch": {
                                                            "type": "number",
                                                            "minimum": 60,
                                                            "maximum": 120
                                                        }
                                                    }
                                                },
                                                "then": {
                                                    "required": ["is_external_door", "colour"]
                                                }
                                            },
                                            {
                                                "if": {
                                                    "not": {
                                                        "anyOf": [
                                                            {"properties": {"pitch": {"const": 0}}},
                                                            {"properties": {"pitch": {"const": 180}}}
                                                        ]
                                                    }
                                                },
                                                "then": {
                                                    "required": ["orientation360"],
                                                    "properties": {
                                                        "orientation360": {
                                                            "type": "integer",
                                                            "minimum": 0,
                                                            "maximum": 360,
                                                            "description": "Degrees from north. Required for any element with a non-flat (0 or 180) pitch"
                                                        }
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "if": {
                                        "properties": {"type": {"const": "BuildingElementPartyWall"}}
                                    },
                                    "then": {
                                        "required": [
                                            "area",
                                            "areal_heat_capacity",
                                            "mass_distribution_class",
                                            "pitch",
                                            "type",
                                            "party_wall_cavity_type"
                                        ],
                                        "properties": {
                                            "area": {
                                                "description": "Area of the building element (m\u00b2), must be positive",
                                                "exclusiveMinimum": 0,
                                                "title": "Area",
                                                "type": "number"
                                            },
                                            "areal_heat_capacity": {
                                                "enum": ["Very light", "Light", "Medium", "Heavy", "Very heavy"]
                                            },
                                            "mass_distribution_class": {
                                                "$ref": "#/$defs/MassDistributionClass"
                                            },
                                            "pitch": {
                                                "description": "Tilt angle of the surface from horizontal, between 60 and 120 degrees (wall range), where 90 means vertical (unit: \u00b0)",
                                                "maximum": 120.0,
                                                "minimum": 60.0,
                                                "title": "Pitch",
                                                "type": "number"
                                            },
                                            "party_wall_cavity_type": {
                                                "$ref": "#/$defs/PartyWallCavityType",
                                                "description": "Type of party wall cavity construction affecting heat loss through air movement"
                                            }
                                        },
                                        "allOf": [
                                            {
                                                "if": {
                                                    "anyOf": [
                                                        {"properties": {"party_wall_cavity_type": {"const": "unfilled_unsealed"}}},
                                                        {"properties": {"party_wall_cavity_type": {"const": "unfilled_sealed"}}},
                                                        {"properties": {"party_wall_cavity_type": {"const": "filled_unsealed"}}}
                                                    ]
                                                },
                                                "then": {
                                                    "required": ["party_wall_lining_type"],
                                                    "properties": {
                                                        "party_wall_lining_type": {
                                                            "$ref": "#/$defs/PartyWallLiningType",
                                                            "description": "Type of party wall lining. Required only when party_wall_cavity_type is unfilled_unsealed, unfilled_sealed, or filled_unsealed"
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "if": {
                                                    "properties": {"party_wall_cavity_type": {"const": "defined_resistance"}}
                                                },
                                                "then": {
                                                    "required": ["thermal_resistance_cavity"],
                                                    "properties": {
                                                        "thermal_resistance_cavity": {
                                                            "type": "number",
                                                            "exclusiveMinimum": 0,
                                                            "description": "Effective thermal resistance of the party wall cavity (unit: m\u00b2.K/W). Required only when party_wall_cavity_type is 'defined_resistance'. For other cavity types, this is calculated automatically.",
                                                            "title": "Thermal Resistance Cavity"
                                                        }
                                                    }
                                                }
                                            }
                                        ]

                                    }
                                },
                                {
                                    "if": {
                                        "properties": {"type": {"const": "BuildingElementTransparent"}}
                                    },
                                    "then": {
                                        "required": [
                                            "frame_area_fraction",
                                            "g_value",
                                            "mid_height",
                                            "max_window_open_area",
                                            "security_risk",
                                            "window_part_list",
                                            "shading",
                                            "base_height",
                                            "height",
                                            "width",
                                            "pitch"
                                        ],
                                        "properties": {
                                            "pitch": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 180
                                            },
                                            "frame_area_fraction": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 1
                                            },
                                            "g_value": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 1
                                            },
                                            "free_area_height": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 100
                                            },
                                            "mid_height": {
                                                "type": "number",
                                                "exclusiveMinimum": 0,
                                                "maximum": 100
                                            },
                                            "max_window_open_area": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 100
                                            },
                                            "security_risk": {"type": "boolean"},
                                            "window_part_list": {
                                                "type": "array",
                                                "items": {
                                                    "type": "object",
                                                    "unevaluatedProperties": false,
                                                    "required": ["mid_height_air_flow_path"],
                                                    "properties": {
                                                        "mid_height_air_flow_path": {
                                                            "type": "number",
                                                            "minimum": 0,
                                                            "maximum": 100
                                                        }
                                                    }
                                                }
                                            },
                                            "shading": {"$ref": "#/$defs/WindowShading"},
                                            "treatment": {
                                                "type": "array",
                                                "items": {
                                                    "type": "object",
                                                    "unevaluatedProperties": false,
                                                    "required": [
                                                        "type",
                                                        "controls",
                                                        "delta_r",
                                                        "trans_red"
                                                    ],
                                                    "properties": {
                                                        "type": {"enum": ["curtains", "blinds"]},
                                                        "controls": {"enum": ["auto_motorised", "manual"]},
                                                        "delta_r": {
                                                            "type": "number",
                                                            "minimum": 0,
                                                            "maximum": 100
                                                        },
                                                        "trans_red": {
                                                            "type": "number",
                                                            "minimum": 0,
                                                            "maximum": 1
                                                        }
                                                    }
                                                }
                                            },
                                            "base_height": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 500
                                            },
                                            "height": {
                                                "type": "number",
                                                "minimum": 0.001,
                                                "maximum": 50
                                            },
                                            "width": {
                                                "type": "number",
                                                "minimum": 0.001,
                                                "maximum": 100
                                            }
                                        },
                                        "if": {
                                            "not": {
                                                "anyOf": [
                                                    {"properties": {"pitch": {"const": 0}}},
                                                    {"properties": {"pitch": {"const": 180}}}
                                                ]
                                            }
                                        },
                                        "then": {
                                            "required": ["orientation360"],
                                            "properties": {
                                                "orientation360": {
                                                    "type": "integer",
                                                    "minimum": 0,
                                                    "maximum": 360,
                                                    "description": "Degrees from north. Required for any element with a non-flat (0 or 180) pitch"
                                                }
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    },
                    "ThermalBridging": {
                        "type": ["object", "number"],
                        "additionalProperties": {
                            "type": "object",
                            "unevaluatedProperties": false,
                            "properties": {
                                "type": {"enum": ["ThermalBridgeLinear", "ThermalBridgePoint"]}
                            },
                            "required": ["type"],
                            "allOf": [
                                {
                                    "if": {
                                        "properties": {"type": {"const": "ThermalBridgeLinear"}}
                                    },
                                    "then": {
                                        "required": [
                                            "linear_thermal_transmittance",
                                            "length",
                                            "junction_type"
                                        ],
                                        "properties": {
                                            "linear_thermal_transmittance": {
                                                "type": "number"
                                            },
                                            "length": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 10000
                                            },
                                            "junction_type": {
                                                "enum": [
                                                    "E1", "E2", "E3", "E4", "E5", "E6", "E7", "E8", "E9", "E10",  "E11", "E12", "E13", "E14", "E15", "E16", "E17", "E18", "E19", "E20", "E21", "E22", "E23", "E24", "E25",
                                                    "P1", "P2", "P3", "P4", "P5", "P6", "P7", "P8",
                                                    "R1", "R2", "R3", "R4", "R5", "R6", "R7", "R8", "R9", "R10",  "R11"
                                                ]
                                            }
                                        }
                                    }
                                },
                                {
                                    "if": {
                                        "properties": {"type": {"const": "ThermalBridgePoint"}}
                                    },
                                    "then": {
                                        "required": ["heat_transfer_coeff"],
                                        "properties": {
                                            "heat_transfer_coeff": {
                                                "type": "number",
                                                "minimum": 0,
                                                "maximum": 2
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    }
                }
            },
            "minProperties": 1,
            "maxProperties": 1
        }
    },
    "if": {
        "properties": {
            "PartO_active_cooling_required": { "const": true }
        }
    },
    "then": {
        "properties": {
            "Zone": {
                "type": "object",
                "additionalProperties": {
                    "required": ["SpaceCoolSystem"]
                }
            }
        }
    },
    "required": [
        "PartGcompliance",
        "BuildingLength",
        "BuildingWidth",
        "NumberOfBedrooms",
        "NumberOfTappedRooms",
        "NumberOfUtilityRooms",
        "NumberOfBathrooms",
        "NumberOfSanitaryAccommodations",
        "NumberOfHabitableRooms",
        "HeatingControlType",
        "ExternalConditions",
        "Appliances",
        "ColdWaterSource",
        "EnergySupply",
        "HotWaterSource",
        "HotWaterDemand",
        "Events",
        "SpaceHeatSystem",
        "General",
        "InfiltrationVentilation",
        "Zone"
    ],
    "$defs": {
        "ElectricityFuelProperties": {
            "properties": {
                "priority": {
                    "items": {
                        "$ref": "#/$defs/EnergySupplyPriorityEntry"
                    },
                    "title": "Priority",
                    "type": "array"
                },
                "is_export_capable": {"type": "boolean"},
                "ElectricBattery": {
                    "type": "object",
                    "unevaluatedProperties": false,
                    "required": [
                        "capacity",
                        "charge_discharge_efficiency_round_trip",
                        "minimum_charge_rate_one_way_trip",
                        "maximum_charge_rate_one_way_trip",
                        "maximum_discharge_rate_one_way_trip",
                        "battery_location"
                    ],
                    "properties": {
                        "capacity": {
                            "type": "number",
                            "exclusiveMinimum": 0,
                            "maximum": 50
                        },
                        "charge_discharge_efficiency_round_trip": {
                            "type": "number",
                            "exclusiveMinimum": 0,
                            "maximum": 1
                        },
                        "minimum_charge_rate_one_way_trip": {
                            "type": "number",
                            "minimum": 0
                        },
                        "maximum_charge_rate_one_way_trip": {
                            "type": "number",
                            "exclusiveMinimum": 0
                        },
                        "maximum_discharge_rate_one_way_trip": {
                            "type": "number",
                            "exclusiveMinimum": 0
                        },
                        "battery_location": {"enum": ["inside", "outside"]}
                    }
                },
                "diverter": {
                    "type": "object",
                    "unevaluatedProperties": false,
                    "required": ["HeatSource"],
                    "properties": {
                        "HeatSource": {"type": "string"}
                    }
                }
            }
        },
        "EnergySupplyPriorityEntry": {
            "enum": [
                "ElectricBattery",
                "diverter"
            ],
            "title": "EnergySupplyPriorityEntry",
            "type": "string"
        },
        "MassDistributionClass": {
            "enum": [
                "I: Mass concentrated at internal side",
                "E: Mass concentrated at external side",
                "IE: Mass divided over internal and external side",
                "D: Mass equally distributed",
                "M: Mass concentrated inside"
            ],
            "title": "MassDistributionClass",
            "type": "string"
        },
        "BoilerCostScheduleHybrid": {
            "additionalProperties": false,
            "properties": {
                "cost_schedule_boiler": {
                    "$ref": "#/$defs/ScheduleForDouble",
                    "description": "Cost data for the fuel used by the hybrid's boiler (can be any units, typically p/kWh)"
                },
                "cost_schedule_hp": {
                    "$ref": "#/$defs/ScheduleForDouble",
                    "description": "Cost data for the fuel used by the hybrid's heat pump (can be any units, typically p/kWh)"
                },
                "cost_schedule_start_day": {
                    "description": "Day on which the cost data series begins",
                    "maximum": 365,
                    "minimum": 0,
                    "title": "Cost Schedule Start Day",
                    "type": "integer"
                },
                "cost_schedule_time_series_step": {
                    "description": "Time step of the cost data series",
                    "title": "Cost Schedule Time Series Step",
                    "type": "number"
                }
            },
            "required": [
                "cost_schedule_boiler",
                "cost_schedule_hp",
                "cost_schedule_start_day",
                "cost_schedule_time_series_step"
            ],
            "title": "BoilerCostScheduleHybrid",
            "type": "object"
        },
        "ScheduleForDouble": {
            "additionalProperties": {
                "items": {
                    "$ref": "#/$defs/ScheduleEntryForDouble"
                },
                "type": "array"
            },
            "description": "A dictionary of schedule entries where:\n- Keys are user-defined names (e.g., \"main\", \"week\", \"weekday\", \"weekend\")\n- Values are lists of ScheduleEntryForDouble\n- The \"main\" entry is required",
            "title": "ScheduleForDouble",
            "type": "object"
        },
        "ScheduleEntryForDouble": {
            "anyOf": [
                {
                    "type": "number"
                },
                {
                    "$ref": "#/$defs/ScheduleRepeaterForDouble"
                },
                {
                    "type": "string"
                },
                {
                    "type": "null"
                }
            ],
            "description": "A schedule entry that can be a direct value, repeating pattern, or reference.\n\nExamples:\n    # Direct float value (temperature setpoint)\n    21.5\n\n    # Repeating pattern (21.5\u00b0C for 8 hours, 18\u00b0C for 16 hours)\n    {\"repeat\": 24, \"value\": 21.5}\n\n    # Reference to another schedule\n    \"weekday_temp_schedule\"\n\n    # Complex repeating pattern with reference\n    {\"repeat\": 7, \"value\": \"daily_temp_pattern\"}\n\n    # Power level schedule\n    2.5  # 2.5 kW constant power",
            "title": "ScheduleEntryForDouble"
        },
        "ScheduleRepeaterForDouble": {
            "additionalProperties": false,
            "description": "Defines a repeating pattern for double (float) schedule values.\n\nExamples:\n    # Repeat temperature setpoint 21.5\u00b0C 24 times (once per hour)\n    {\"repeat\": 24, \"value\": 21.5}\n\n    # Reference another schedule, repeat 7 times (once per day)\n    {\"repeat\": 7, \"value\": \"weekday_temp_schedule\"}\n\n    # Repeat power level 2.5 kW for 8 hours\n    {\"repeat\": 8, \"value\": 2.5}",
            "properties": {
                "repeat": {
                    "description": "Number of times to repeat the value",
                    "minimum": 1,
                    "title": "Repeat",
                    "type": "integer"
                },
                "value": {
                    "$ref": "#/$defs/ScheduleRepeaterValueForDouble",
                    "description": "Value to repeat or schedule reference"
                }
            },
            "required": [
                "repeat",
                "value"
            ],
            "title": "ScheduleRepeaterForDouble",
            "type": "object"
        },
        "ScheduleRepeaterValueForDouble": {
            "anyOf": [
                {
                    "type": "string"
                },
                {
                    "$ref": "#/$defs/ScheduleRepeaterEntryForDouble"
                }
            ],
            "title": "ScheduleRepeaterValueForDouble"
        },
        "ScheduleRepeaterEntryForDouble": {
            "anyOf": [
                {
                    "type": "number"
                },
                {
                    "type": "null"
                }
            ],
            "title": "ScheduleRepeaterEntryForDouble"
        },
        "PartyWallCavityType": {
            "description": "Types of party wall cavity configurations",
            "enum": [
                "solid",
                "unfilled_unsealed",
                "unfilled_sealed",
                "filled_sealed",
                "filled_unsealed",
                "defined_resistance"
            ],
            "title": "PartyWallCavityType",
            "type": "string"
        },
        "PartyWallLiningType": {
            "description": "Types of party wall lining",
            "enum": [
                "wet_plaster",
                "dry_lined"
            ],
            "title": "PartyWallLiningType",
            "type": "string"
        },
        "WindowShading": {
            "type": "array",
            "items": {
                "type": "object",
                "unevaluatedProperties": false,
                "required": [
                    "type",
                    "distance"
                ],
                "properties": {
                    "type": {"enum": ["obstacle", "overhang", "sidefinleft", "sidefinright", "reveal"]},
                    "distance": {
                        "type": "number",
                        "minimum": 0
                    }
                },
                "if": {
                    "properties": {"type": {"const": "obstacle"}}
                },
                "then": {
                    "required": ["height", "transparency"],
                    "properties": {
                        "height": {
                            "type": "number",
                            "exclusiveMinimum": 0
                        },
                        "transparency": {
                            "type": "number",
                            "minimum": 0,
                            "maximum": 1
                        }
                    }
                },
                "else": {
                    "required": ["depth"],
                    "properties": {
                        "depth": {
                            "type": "number",
                            "exclusiveMinimum": 0
                        }
                    }

                }
            }
        }
    }
}
